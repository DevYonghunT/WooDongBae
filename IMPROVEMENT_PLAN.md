# ğŸ” ìš°ë™ë°°(WooDongBae) í”„ë¡œì íŠ¸ ì¢…í•© ê°œì„  ê³„íšì„œ

> ì‘ì„±ì¼: 2026-01-26
> ëŒ€ìƒ: ì§€ìì²´ ë„ì„œê´€ ê°•ì¢Œ ìŠ¤í¬ë˜í•‘/ì œê³µ ì„œë¹„ìŠ¤
> ëª©í‘œ: ìƒìš© ì„œë¹„ìŠ¤ ìˆ˜ì¤€ìœ¼ë¡œ íšŒì› ê¸°ëŠ¥ ë° ì•Œë¦¼ ì‹œìŠ¤í…œ ê³ ë„í™”

---

## ğŸ“Š í”„ë¡œì íŠ¸ í˜„í™© ìš”ì•½

**ê¸°ìˆ  ìŠ¤íƒ**: Next.js 16 + React 19 + TypeScript + Supabase + Tailwind CSS
**ì£¼ìš” ê¸°ëŠ¥**: ì§€ìì²´ ë„ì„œê´€ ê°•ì¢Œ ìŠ¤í¬ë˜í•‘/ê²€ìƒ‰, ì°œí•˜ê¸°, í‚¤ì›Œë“œ ì•Œë¦¼, ì»¤ë®¤ë‹ˆí‹°
**ë°°í¬ í™˜ê²½**: Vercel (ì¶”ì •)

**í˜„ì¬ êµ¬í˜„ëœ ê¸°ëŠ¥:**
- âœ… ì¹´ì¹´ì˜¤/êµ¬ê¸€ ì†Œì…œ ë¡œê·¸ì¸
- âœ… ê°•ì¢Œ ê²€ìƒ‰ ë° í•„í„°ë§
- âœ… ì°œí•˜ê¸° ê¸°ëŠ¥
- âœ… í‚¤ì›Œë“œ ì•Œë¦¼ (ì´ë©”ì¼/í‘¸ì‹œ)
- âœ… ì°œí•œ ê°•ì¢Œ ì¼ì • ì•Œë¦¼
- âœ… ì»¤ë®¤ë‹ˆí‹° (ê³µì§€ì‚¬í•­/ììœ ê²Œì‹œíŒ)
- âœ… PWA ì§€ì›
- âœ… AI ê¸°ë°˜ ìŠ¤í¬ë˜í•‘ (Playwright + Gemini)

---

## âš ï¸ í•µì‹¬ ë¬¸ì œì  ë° ê°œì„  ìš°ì„ ìˆœìœ„

### ğŸ”´ Priority 1: íšŒì› ê¸°ëŠ¥ ë° ì•Œë¦¼ ì‹œìŠ¤í…œ ê°•í™” (ì¦‰ì‹œ ê°œì„  í•„ìš”)

í˜„ì¬ íšŒì› ê¸°ëŠ¥ê³¼ ì•Œë¦¼ ì‹œìŠ¤í…œì´ ìƒìš© ì„œë¹„ìŠ¤ ìˆ˜ì¤€ì— ë¹„í•´ ë¶€ì¡±í•©ë‹ˆë‹¤:

**ì•Œë¦¼ ì‹œìŠ¤í…œ ë¬¸ì œ:**
- âŒ ì•Œë¦¼ ì„¤ì • ì»¤ìŠ¤í„°ë§ˆì´ì§• ë¶ˆê°€ (ì‹œê°„ëŒ€, ë¹ˆë„, ì±„ë„ ì„ íƒ ë“±)
- âŒ ì•Œë¦¼ íˆìŠ¤í† ë¦¬ ê´€ë¦¬ ë¯¸í¡
- âŒ ì‹¤ì‹œê°„ì„± ë¶€ì¡± (ë°°ì¹˜ Job ë°©ì‹)
- âŒ ì•Œë¦¼ í†µê³„ ë° íš¨ê³¼ ì¸¡ì • ë¶ˆê°€

**íšŒì› ê¸°ëŠ¥ ë¬¸ì œ:**
- âŒ í”„ë¡œí•„ í¸ì§‘ ë¶ˆê°€ (ë‹‰ë„¤ì„, í”„ë¡œí•„ ì´ë¯¸ì§€ ë³€ê²½)
- âŒ íšŒì› í™œë™ íˆìŠ¤í† ë¦¬ ì—†ìŒ
- âŒ ì´ë©”ì¼ íšŒì›ê°€ì… ë¯¸ì§€ì› (ì†Œì…œ ë¡œê·¸ì¸ë§Œ ê°€ëŠ¥)
- âŒ íšŒì› íƒˆí‡´ ë° ë°ì´í„° ì‚­ì œ ê¸°ëŠ¥ ì—†ìŒ
- âŒ ì´ìš©ì•½ê´€/ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ ë¯¸ë¹„

**ë³´ì•ˆ ë¬¸ì œ:**
- âŒ ì»¤ë®¤ë‹ˆí‹° ë¹„ë°€ë²ˆí˜¸ í‰ë¬¸ ì €ì¥ ê°€ëŠ¥ì„±
- âŒ Rate Limiting ë¶€ì¬
- âŒ CSRF í† í° ë¯¸í¡
- âŒ í™˜ê²½ë³€ìˆ˜ ì¼ë¶€ í•˜ë“œì½”ë”©

**ì„±ëŠ¥ ë¬¸ì œ:**
- âŒ N+1 ì¿¼ë¦¬ ë¬¸ì œ (ì°œ ì—¬ë¶€ í™•ì¸ ì‹œ)
- âŒ ìºì‹± ì „ëµ ë¶€ì¬
- âŒ DB ì¸ë±ìŠ¤ ìµœì í™” í•„ìš”
- âŒ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì „ë¬´

---

## ğŸ“ ì¢…í•© ì‹¤í–‰ ê³„íš (ìš°ì„ ìˆœìœ„ë³„)

### ğŸ”´ Phase 1: ì¦‰ì‹œ ê°œì„  (1-2ì£¼)
1. **ì•Œë¦¼ ì‹œìŠ¤í…œ ì „ë©´ ê°œì„ ** â†’ [í”„ë¡¬í”„íŠ¸ 1ë²ˆ ì°¸ì¡°](#1ï¸âƒ£-ì•Œë¦¼-ì‹œìŠ¤í…œ-ì „ë©´-ê°œì„ -ìµœìš°ì„ )
2. **íšŒì› ê¸°ëŠ¥ ê°•í™”** â†’ [í”„ë¡¬í”„íŠ¸ 2ë²ˆ ì°¸ì¡°](#2ï¸âƒ£-íšŒì›-ê¸°ëŠ¥-ê°•í™”-ìƒìš©-ì„œë¹„ìŠ¤-ìˆ˜ì¤€)
3. **ë³´ì•ˆ ì·¨ì•½ì  í•´ê²°** â†’ [í”„ë¡¬í”„íŠ¸ 4ë²ˆ ì°¸ì¡°](#4ï¸âƒ£-ë³´ì•ˆ-ì·¨ì•½ì -í•´ê²°)

### ğŸŸ¡ Phase 2: ë‹¨ê¸° ê°œì„  (2-4ì£¼)
4. **ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”** â†’ [í”„ë¡¬í”„íŠ¸ 3ë²ˆ ì°¸ì¡°](#3ï¸âƒ£-ë°ì´í„°ë² ì´ìŠ¤-ìµœì í™”-ë°-ë³´ì•ˆ-ê°•í™”)
5. **ì„±ëŠ¥ ìµœì í™”** â†’ [í”„ë¡¬í”„íŠ¸ 5ë²ˆ ì°¸ì¡°](#5ï¸âƒ£-ì„±ëŠ¥-ìµœì í™”)
6. **UX ê°œì„ ** â†’ [í”„ë¡¬í”„íŠ¸ 6ë²ˆ ì°¸ì¡°](#6ï¸âƒ£-ì‚¬ìš©ì-ê²½í—˜ux-ê°œì„ )

### ğŸŸ¢ Phase 3: ì¤‘ì¥ê¸° ê°œì„  (1-2ê°œì›”)
7. **í…ŒìŠ¤íŠ¸ ë° ëª¨ë‹ˆí„°ë§** â†’ [í”„ë¡¬í”„íŠ¸ 7ë²ˆ ì°¸ì¡°](#7ï¸âƒ£-í…ŒìŠ¤íŠ¸-ë°-ëª¨ë‹ˆí„°ë§)
8. **ì¶”ê°€ ê¸°ëŠ¥ êµ¬í˜„** â†’ [í”„ë¡¬í”„íŠ¸ 8ë²ˆ ì°¸ì¡°](#8ï¸âƒ£-ì¶”ê°€-ê¸°ëŠ¥-ì œì•ˆ-ìš°ì„ ìˆœìœ„-ë‚®ìŒ-í–¥í›„-í™•ì¥)

---

## ğŸš€ AI ì—ì´ì „íŠ¸ ì‹¤í–‰ í”„ë¡¬í”„íŠ¸ (ì¹´í…Œê³ ë¦¬ë³„)

> ê° í”„ë¡¬í”„íŠ¸ëŠ” ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ ê°€ëŠ¥í•˜ë©°, AI ì—ì´ì „íŠ¸ì— ë³µì‚¬/ë¶™ì—¬ë„£ê¸°í•˜ì—¬ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## 1ï¸âƒ£ ì•Œë¦¼ ì‹œìŠ¤í…œ ì „ë©´ ê°œì„  (ìµœìš°ì„ )

```
# ì‘ì—… ëª…: ì•Œë¦¼ ì‹œìŠ¤í…œ ìƒìš© ì„œë¹„ìŠ¤ ìˆ˜ì¤€ ì—…ê·¸ë ˆì´ë“œ

## ë°°ê²½
í˜„ì¬ ì•Œë¦¼ ê¸°ëŠ¥ì€ í‚¤ì›Œë“œ ë§¤ì¹­ê³¼ ì°œí•œ ê°•ì¢Œ ì¼ì • ì•Œë¦¼ë§Œ ì œê³µí•˜ë©°, ë‹¤ìŒ ë¬¸ì œë“¤ì´ ìˆìŠµë‹ˆë‹¤:
- ì•Œë¦¼ ì„¤ì • ì»¤ìŠ¤í„°ë§ˆì´ì§• ë¶ˆê°€ (ì‹œê°„ëŒ€, ë¹ˆë„, ì±„ë„ ì„ íƒ ë“±)
- ì•Œë¦¼ íˆìŠ¤í† ë¦¬ ê´€ë¦¬ ë¯¸í¡ (notifications í…Œì´ë¸”ì€ ìˆìœ¼ë‚˜ í™œìš© ì œí•œì )
- ì‹¤ì‹œê°„ì„± ë¶€ì¡± (ë°°ì¹˜ Job ë°©ì‹)
- ì•Œë¦¼ í†µê³„ ë° íš¨ê³¼ ì¸¡ì • ë¶ˆê°€

## ê°œì„  ì‘ì—…

### 1-1. ì•Œë¦¼ ì„¤ì • í…Œì´ë¸” í™•ì¥
íŒŒì¼: supabase/schema.sql ë˜ëŠ” ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìƒì„±

ë‹¤ìŒ í…Œì´ë¸”ì„ ì¶”ê°€í•˜ì„¸ìš”:

```sql
-- ì‚¬ìš©ìë³„ ì•Œë¦¼ ì„¤ì •
CREATE TABLE notification_preferences (
    id BIGSERIAL PRIMARY KEY,
    user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,

    -- ì•Œë¦¼ ì±„ë„ ON/OFF
    email_enabled BOOLEAN DEFAULT true,
    push_enabled BOOLEAN DEFAULT true,

    -- ì•Œë¦¼ íƒ€ì…ë³„ ì„¤ì •
    keyword_alert_enabled BOOLEAN DEFAULT true,
    bookmark_alert_enabled BOOLEAN DEFAULT true,
    community_reply_enabled BOOLEAN DEFAULT false, -- í–¥í›„ í™•ì¥

    -- ì•Œë¦¼ ìˆ˜ì‹  ì‹œê°„ëŒ€ (ì¡°ìš©í•œ ì‹œê°„ ì„¤ì •)
    quiet_hours_start TIME DEFAULT '22:00:00',
    quiet_hours_end TIME DEFAULT '08:00:00',

    -- ì•Œë¦¼ ë¹ˆë„ ì œí•œ (1: ì‹¤ì‹œê°„, 2: 1ì‹œê°„ ìš”ì•½, 3: 1ì¼ ìš”ì•½)
    frequency_type INTEGER DEFAULT 1,

    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),

    UNIQUE(user_id)
);

-- ì•Œë¦¼ ì „ì†¡ ë¡œê·¸ (ë¶„ì„ìš©)
CREATE TABLE notification_logs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
    notification_id UUID REFERENCES notifications(id) ON DELETE SET NULL,

    type VARCHAR(50), -- 'keyword_match', 'bookmark_reminder', 'community_reply'
    channel VARCHAR(20), -- 'email', 'push'
    status VARCHAR(20), -- 'sent', 'failed', 'skipped'
    error_message TEXT,

    sent_at TIMESTAMPTZ DEFAULT NOW(),

    INDEX idx_user_sent (user_id, sent_at),
    INDEX idx_type_status (type, status)
);
```

### 1-2. ì•Œë¦¼ ì„¤ì • UI êµ¬í˜„
íŒŒì¼: /components/NotificationSettingsPanel.tsx (ìƒˆ íŒŒì¼)

ë‹¤ìŒ ê¸°ëŠ¥ì„ í¬í•¨í•˜ëŠ” ì•Œë¦¼ ì„¤ì • íŒ¨ë„ì„ ë§Œë“œì„¸ìš”:
- ì•Œë¦¼ ì±„ë„ë³„ ON/OFF í† ê¸€ (ì´ë©”ì¼, í‘¸ì‹œ)
- ì•Œë¦¼ íƒ€ì…ë³„ ì„¸ë¶€ ì„¤ì • (í‚¤ì›Œë“œ ì•Œë¦¼, ì°œ ì•Œë¦¼ ë“±)
- ì¡°ìš©í•œ ì‹œê°„ ì„¤ì • (ì‹œì‘/ì¢…ë£Œ ì‹œê°„ ì„ íƒ)
- ì•Œë¦¼ ë¹ˆë„ ì„ íƒ (ì‹¤ì‹œê°„/ì‹œê°„ë³„ ìš”ì•½/ì¼ë³„ ìš”ì•½)
- í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ë°œì†¡ ë²„íŠ¼

ë””ìì¸ì€ ê¸°ì¡´ ìš°ë™ë°° ìŠ¤íƒ€ì¼(Tailwind + Lucide Icons)ì„ ë”°ë¥´ë˜, ë‹¤ìŒ UX ì›ì¹™ì„ ì§€í‚¤ì„¸ìš”:
- ê° ì„¤ì •ì˜ íš¨ê³¼ë¥¼ ëª…í™•íˆ ì„¤ëª…í•˜ëŠ” ë„ì›€ë§ íˆ´íŒ
- ì„¤ì • ë³€ê²½ ì¦‰ì‹œ ì €ì¥ (ë‚™ê´€ì  UI)
- ì—ëŸ¬ ë°œìƒ ì‹œ ì›ìƒë³µêµ¬ ë° ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€

ì´ ì»´í¬ë„ŒíŠ¸ë¥¼ /app/mypage/page.tsxì— ì„¸ ë²ˆì§¸ ì¹´ë“œë¡œ ì¶”ê°€í•˜ì„¸ìš”.

### 1-3. ì•Œë¦¼ íˆìŠ¤í† ë¦¬ UI ê°œì„ 
íŒŒì¼: /components/NotificationModal.tsx

í˜„ì¬ NotificationModalì„ ë‹¤ìŒê³¼ ê°™ì´ ê°œì„ í•˜ì„¸ìš”:
1. í•„í„°ë§ ê¸°ëŠ¥ ì¶”ê°€:
   - ì•Œë¦¼ íƒ€ì…ë³„ í•„í„° (ì „ì²´/í‚¤ì›Œë“œ/ì°œ/ì»¤ë®¤ë‹ˆí‹°)
   - ì½ìŒ/ì•ˆì½ìŒ í•„í„°
   - ë‚ ì§œ ë²”ìœ„ í•„í„°

2. ë¬´í•œ ìŠ¤í¬ë¡¤ êµ¬í˜„:
   - í˜„ì¬ limit(20) ëŒ€ì‹  ìŠ¤í¬ë¡¤ ì‹œ ì¶”ê°€ ë¡œë“œ
   - react-intersection-observer ë˜ëŠ” ë„¤ì´í‹°ë¸Œ IntersectionObserver ì‚¬ìš©

3. ì•Œë¦¼ ì•¡ì…˜ ì¶”ê°€:
   - ê°œë³„ ì•Œë¦¼ ìš°ì¸¡ì— "ë‹¤ì‹œ ë³´ì§€ ì•Šê¸°" ë²„íŠ¼
   - ë²Œí¬ ì‚­ì œ (ì„ íƒëœ í•­ëª© ì‚­ì œ)
   - ì•Œë¦¼ ìŠ¤ëˆ„ì¦ˆ ê¸°ëŠ¥ (1ì‹œê°„ í›„/ë‚´ì¼/1ì£¼ì¼ í›„)

4. ì•Œë¦¼ í†µê³„ ì„¹ì…˜:
   - ìƒë‹¨ì— "ì´ë²ˆ ì£¼ ë°›ì€ ì•Œë¦¼ í†µê³„" ì¹´ë“œ ì¶”ê°€
   - íƒ€ì…ë³„ ì•Œë¦¼ ìˆ˜, í´ë¦­ë¥  ë“± í‘œì‹œ

### 1-4. ì‹¤ì‹œê°„ ì•Œë¦¼ ì¸í”„ë¼ êµ¬ì¶•
íŒŒì¼: /lib/realtime-notification.ts (ìƒˆ íŒŒì¼)

í˜„ì¬ ë°°ì¹˜ Job ë°©ì‹ ëŒ€ì‹ , Supabase Realtimeì„ í™œìš©í•œ ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ì„¸ìš”:

```typescript
// Supabase Realtime êµ¬ë… ì˜ˆì‹œ
export function subscribeToRealtimeNotifications(userId: string, onNotification: (noti: Notification) => void) {
    const supabase = createClient();

    const channel = supabase
        .channel('notifications')
        .on(
            'postgres_changes',
            {
                event: 'INSERT',
                schema: 'public',
                table: 'notifications',
                filter: `user_id=eq.${userId}`
            },
            (payload) => {
                onNotification(payload.new as Notification);
                // ë¸Œë¼ìš°ì € ì•Œë¦¼ í‘œì‹œ
                if (Notification.permission === 'granted') {
                    new Notification(payload.new.title, {
                        body: payload.new.message,
                        icon: '/icon.png'
                    });
                }
            }
        )
        .subscribe();

    return () => { channel.unsubscribe(); };
}
```

ì´ë¥¼ Header.tsx ë˜ëŠ” layout.tsxì—ì„œ ì‚¬ìš©ì ë¡œê·¸ì¸ ì‹œ ìë™ êµ¬ë…í•˜ë„ë¡ êµ¬í˜„í•˜ì„¸ìš”.

### 1-5. ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ë°°ì¹˜ ì‹œìŠ¤í…œ
íŒŒì¼: /scrapers/alert-job.ts, /scrapers/bookmark-alert-job.ts

ê¸°ì¡´ ì•Œë¦¼ Jobë“¤ì„ ë‹¤ìŒê³¼ ê°™ì´ ê°œì„ í•˜ì„¸ìš”:

1. notification_preferences í…Œì´ë¸” ì°¸ì¡°:
   - ì‚¬ìš©ìì˜ ì•Œë¦¼ ì„¤ì • í™•ì¸ (ì±„ë„, ì¡°ìš©í•œ ì‹œê°„, ë¹ˆë„)
   - ì„¤ì •ì— ë”°ë¼ ë°œì†¡ ì—¬ë¶€ ê²°ì •

2. ì•Œë¦¼ ê·¸ë£¹í™” (ë¹ˆë„ ì„¤ì •ì´ "ìš”ì•½"ì¸ ê²½ìš°):
   - ì‹¤ì‹œê°„ì´ ì•„ë‹Œ ê²½ìš°, ì„ì‹œ íì— ì €ì¥
   - ì„¤ì •ëœ ì‹œê°„ì— í•œ ë²ˆì— ìš”ì•½ ë°œì†¡

3. ë°œì†¡ ë¡œê·¸ ê¸°ë¡:
   - notification_logs í…Œì´ë¸”ì— ëª¨ë“  ë°œì†¡ ì‹œë„ ê¸°ë¡
   - ì„±ê³µ/ì‹¤íŒ¨ ì—¬ë¶€, ì—ëŸ¬ ë©”ì‹œì§€ ì €ì¥

4. ì‹¤íŒ¨ ì¬ì‹œë„ ë¡œì§:
   - ì‹¤íŒ¨í•œ ì•Œë¦¼ì€ exponential backoffë¡œ 3íšŒ ì¬ì‹œë„
   - 3íšŒ ì‹¤íŒ¨ ì‹œ ì‚¬ìš©ìì—ê²Œ "ì•Œë¦¼ ì„¤ì • í™•ì¸ í•„ìš”" ë©”ì‹œì§€

ì˜ˆì‹œ ì½”ë“œ:
```typescript
// ì‚¬ìš©ì ì„¤ì • í™•ì¸
const { data: prefs } = await supabase
    .from('notification_preferences')
    .select('*')
    .eq('user_id', userId)
    .single();

// ì¡°ìš©í•œ ì‹œê°„ ì²´í¬
const now = new Date();
const currentTime = now.toTimeString().slice(0, 8);
if (prefs.quiet_hours_start < prefs.quiet_hours_end) {
    if (currentTime >= prefs.quiet_hours_start && currentTime <= prefs.quiet_hours_end) {
        console.log('ì¡°ìš©í•œ ì‹œê°„ - ì•Œë¦¼ ìŠ¤í‚µ');
        return;
    }
}

// ì±„ë„ë³„ ë°œì†¡
if (prefs.email_enabled) {
    const result = await sendEmail(...);
    await logNotification(userId, 'email', result.success ? 'sent' : 'failed');
}
if (prefs.push_enabled) {
    const result = await sendPush(...);
    await logNotification(userId, 'push', result.success ? 'sent' : 'failed');
}
```

### 1-6. ì•Œë¦¼ ë¶„ì„ ëŒ€ì‹œë³´ë“œ (ê´€ë¦¬ììš©)
íŒŒì¼: /app/admin/notifications/page.tsx (ìƒˆ íŒŒì¼)

ê´€ë¦¬ì í˜ì´ì§€ì— ì•Œë¦¼ í†µê³„ ëŒ€ì‹œë³´ë“œë¥¼ ì¶”ê°€í•˜ì„¸ìš”:
- ì´ ë°œì†¡ ìˆ˜, ì„±ê³µë¥ , ì‹¤íŒ¨ìœ¨
- íƒ€ì…ë³„ ì•Œë¦¼ í†µê³„
- ì‚¬ìš©ìë³„ ì•Œë¦¼ ìˆ˜ì‹  í˜„í™©
- ì‹œê°„ëŒ€ë³„ ë°œì†¡ëŸ‰ ê·¸ë˜í”„
- ì‹¤íŒ¨ ì›ì¸ Top 5

ë°ì´í„°ëŠ” notification_logs í…Œì´ë¸”ì—ì„œ ì§‘ê³„í•˜ë©°, ì°¨íŠ¸ëŠ” ê°„ë‹¨í•œ HTML/CSS ë§‰ëŒ€ ê·¸ë˜í”„ ë˜ëŠ” recharts ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤.

## ì˜ˆìƒ ê²°ê³¼
ì´ ì‘ì—…ì„ ì™„ë£Œí•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ íš¨ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- ì‚¬ìš©ìê°€ ì•Œë¦¼ì„ ì„¸ë°€í•˜ê²Œ ì œì–´ ê°€ëŠ¥ (ë¶ˆí•„ìš”í•œ ì•Œë¦¼ ë°©ì§€)
- ì•Œë¦¼ ì „ë‹¬ ì•ˆì •ì„± í–¥ìƒ (ì¬ì‹œë„ ë¡œì§)
- ì‹¤ì‹œê°„ ì•Œë¦¼ìœ¼ë¡œ ì‚¬ìš©ì ê²½í—˜ ê°œì„ 
- ì•Œë¦¼ íš¨ê³¼ ì¸¡ì •ì„ í†µí•œ ê°œì„  ë°©í–¥ ë„ì¶œ
```

---

## 2ï¸âƒ£ íšŒì› ê¸°ëŠ¥ ê°•í™” (ìƒìš© ì„œë¹„ìŠ¤ ìˆ˜ì¤€)

```
# ì‘ì—… ëª…: íšŒì› ê´€ë¦¬ ì‹œìŠ¤í…œ ê³ ë„í™”

## ë°°ê²½
í˜„ì¬ íšŒì› ê¸°ëŠ¥ì€ ì¹´ì¹´ì˜¤/êµ¬ê¸€ ì†Œì…œ ë¡œê·¸ì¸ë§Œ ì§€ì›í•˜ë©°, ë‹¤ìŒ ê¸°ëŠ¥ì´ ë¶€ì¡±í•©ë‹ˆë‹¤:
- í”„ë¡œí•„ í¸ì§‘ (ë‹‰ë„¤ì„, í”„ë¡œí•„ ì´ë¯¸ì§€ ë³€ê²½)
- íšŒì› í™œë™ íˆìŠ¤í† ë¦¬ (ì°œí•œ ê°•ì¢Œ íˆìŠ¤í† ë¦¬, ì•Œë¦¼ ìˆ˜ì‹  ì´ë ¥)
- ì´ë©”ì¼ íšŒì›ê°€ì… ì˜µì…˜
- íšŒì› íƒˆí‡´ ë° ë°ì´í„° ì‚­ì œ ìš”ì²­
- ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • (ì´ë©”ì¼ ê°€ì… ì‹œ)

## ê°œì„  ì‘ì—…

### 2-1. í”„ë¡œí•„ í¸ì§‘ ê¸°ëŠ¥
íŒŒì¼: /components/ProfileEditModal.tsx (ìƒˆ íŒŒì¼)

í”„ë¡œí•„ í¸ì§‘ ëª¨ë‹¬ì„ ìƒì„±í•˜ì„¸ìš”. ë‹¤ìŒ ê¸°ëŠ¥ í¬í•¨:
1. ë‹‰ë„¤ì„ ë³€ê²½:
   - 2~20ì, íŠ¹ìˆ˜ë¬¸ì ì œí•œ
   - ì¤‘ë³µ ì²´í¬ (profiles í…Œì´ë¸”ì— nickname ì»¬ëŸ¼ ì¶”ê°€ í•„ìš”)
   - ë³€ê²½ ì‹œ Supabase user_metadata ì—…ë°ì´íŠ¸

2. í”„ë¡œí•„ ì´ë¯¸ì§€ ë³€ê²½:
   - Supabase Storageì— ì—…ë¡œë“œ (ë²„í‚·: 'avatars')
   - ì´ë¯¸ì§€ í¬ê¸° ì œí•œ (2MB ì´í•˜)
   - ì´ë¯¸ì§€ ì••ì¶• ë° ë¦¬ì‚¬ì´ì§• (browser-image-compression ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©)
   - ì—…ë¡œë“œ ì§„í–‰ ìƒíƒœ í‘œì‹œ

3. ê¸°ë³¸ ì •ë³´ í‘œì‹œ (ì½ê¸° ì „ìš©):
   - ê°€ì…ì¼
   - ë§ˆì§€ë§‰ ë¡œê·¸ì¸ ì¼ì‹œ
   - ê°€ì… ë°©ë²• (ì¹´ì¹´ì˜¤/êµ¬ê¸€/ì´ë©”ì¼)

íŒŒì¼: /app/mypage/page.tsx
- í”„ë¡œí•„ ì¹´ë“œ ìš°ì¸¡ ìƒë‹¨ì— "í¸ì§‘" ë²„íŠ¼ ì¶”ê°€
- í´ë¦­ ì‹œ ProfileEditModal ì—´ê¸°

### 2-2. í™œë™ íˆìŠ¤í† ë¦¬ íƒ­
íŒŒì¼: /app/mypage/history/page.tsx (ìƒˆ íŒŒì¼)

ë§ˆì´í˜ì´ì§€ì— "í™œë™ íˆìŠ¤í† ë¦¬" íƒ­ì„ ì¶”ê°€í•˜ì„¸ìš”:

```typescript
interface ActivityLog {
    id: string;
    user_id: string;
    action: string; // 'bookmark_added', 'bookmark_removed', 'keyword_added', 'keyword_removed', 'notification_received'
    target_id: string; // ê°•ì¢Œ ID, í‚¤ì›Œë“œ ID ë“±
    metadata: Record<string, any>; // ì•¡ì…˜ë³„ ì¶”ê°€ ë°ì´í„°
    created_at: string;
}

// DB í…Œì´ë¸” ìƒì„±
CREATE TABLE activity_logs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
    action VARCHAR(50) NOT NULL,
    target_id TEXT,
    metadata JSONB,
    created_at TIMESTAMPTZ DEFAULT NOW(),

    INDEX idx_user_created (user_id, created_at DESC)
);
```

UI êµ¬ì„±:
- íƒ€ì„ë¼ì¸ í˜•ì‹ìœ¼ë¡œ í™œë™ í‘œì‹œ
- í•„í„°: ì „ì²´/ì°œí•˜ê¸°/í‚¤ì›Œë“œ/ì•Œë¦¼
- ë‚ ì§œ ë²”ìœ„ ì„ íƒ
- ë¬´í•œ ìŠ¤í¬ë¡¤

ê° í™œë™ í•­ëª©ì— ê´€ë ¨ ê°•ì¢Œë¡œ ì´ë™í•˜ëŠ” ë§í¬ í¬í•¨.

### 2-3. ì´ë©”ì¼ íšŒì›ê°€ì… ì¶”ê°€
íŒŒì¼: /components/EmailSignupModal.tsx (ìƒˆ íŒŒì¼)

ê¸°ì¡´ LoginModalì— "ì´ë©”ì¼ë¡œ ì‹œì‘í•˜ê¸°" ì˜µì…˜ì„ ì¶”ê°€í•˜ì„¸ìš”:

1. íšŒì›ê°€ì… í¼:
   - ì´ë©”ì¼ (ìœ íš¨ì„± ê²€ì‚¬)
   - ë¹„ë°€ë²ˆí˜¸ (8ì ì´ìƒ, ì˜ë¬¸+ìˆ«ì í¬í•¨)
   - ë¹„ë°€ë²ˆí˜¸ í™•ì¸
   - ë‹‰ë„¤ì„
   - ì´ìš©ì•½ê´€ ë™ì˜ ì²´í¬ë°•ìŠ¤

2. Supabase Auth ì—°ë™:
```typescript
const { data, error } = await supabase.auth.signUp({
    email,
    password,
    options: {
        data: {
            full_name: nickname,
        },
        emailRedirectTo: `${window.location.origin}/auth/callback`
    }
});
```

3. ì´ë©”ì¼ ì¸ì¦:
   - Supabaseì—ì„œ ìë™ìœ¼ë¡œ ì¸ì¦ ì´ë©”ì¼ ë°œì†¡
   - ì¸ì¦ ì™„ë£Œ ì „ê¹Œì§€ ì¼ë¶€ ê¸°ëŠ¥ ì œí•œ (ì°œí•˜ê¸° ê°€ëŠ¥, ì•Œë¦¼ êµ¬ë… ë¶ˆê°€)

4. ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •:
   - "ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠìœ¼ì…¨ë‚˜ìš”?" ë§í¬ ì¶”ê°€
   - ì´ë©”ì¼ ì…ë ¥ â†’ ì¬ì„¤ì • ë§í¬ ë°œì†¡
   - Supabase `resetPasswordForEmail()` ì‚¬ìš©

### 2-4. íšŒì› íƒˆí‡´ ê¸°ëŠ¥
íŒŒì¼: /app/mypage/delete-account/page.tsx (ìƒˆ íŒŒì¼)

íšŒì› íƒˆí‡´ í˜ì´ì§€ë¥¼ ìƒì„±í•˜ì„¸ìš”:

1. íƒˆí‡´ ì „ í™•ì¸ ì‚¬í•­ í‘œì‹œ:
   - ì‚­ì œë  ë°ì´í„° ëª©ë¡ (ì°œí•œ ê°•ì¢Œ, ì•Œë¦¼ í‚¤ì›Œë“œ, í™œë™ ë¡œê·¸ ë“±)
   - ë³µêµ¬ ë¶ˆê°€ëŠ¥ ê²½ê³ 
   - ì¬ê°€ì… ì‹œ ìƒˆ ê³„ì •ìœ¼ë¡œ ì‹œì‘ë¨ì„ ì•ˆë‚´

2. íƒˆí‡´ ì‚¬ìœ  ì„ íƒ (ì„ íƒì‚¬í•­):
   - ë“œë¡­ë‹¤ìš´: "ì„œë¹„ìŠ¤ê°€ ìœ ìš©í•˜ì§€ ì•ŠìŒ", "ê°œì¸ì •ë³´ ìš°ë ¤", "ì‚¬ìš© ë¹ˆë„ ë‚®ìŒ", "ê¸°íƒ€"
   - ê¸°íƒ€ ì„ íƒ ì‹œ í…ìŠ¤íŠ¸ ì…ë ¥ë€

3. í™•ì¸ ì ˆì°¨:
   - "ì •ë§ë¡œ íƒˆí‡´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?" ì²´í¬ë°•ìŠ¤
   - ì†Œì…œ ë¡œê·¸ì¸ ì‚¬ìš©ì: "í™•ì¸" ë²„íŠ¼ í´ë¦­
   - ì´ë©”ì¼ ì‚¬ìš©ì: ë¹„ë°€ë²ˆí˜¸ ì¬ì…ë ¥ í•„ìˆ˜

4. íƒˆí‡´ ì²˜ë¦¬:
```typescript
// ì„œë²„ ì•¡ì…˜: /app/actions/delete-account.ts
export async function deleteAccount(userId: string, reason?: string) {
    // 1. ì—°ê´€ ë°ì´í„° ì‚­ì œ (CASCADEë¡œ ìë™ ì‚­ì œë˜ì§€ ì•ŠëŠ” ê²ƒë“¤)
    await supabase.from('activity_logs').delete().eq('user_id', userId);
    await supabase.from('notification_logs').delete().eq('user_id', userId);

    // 2. íƒˆí‡´ ë¡œê·¸ ì €ì¥ (í†µê³„ìš©, ë³„ë„ í…Œì´ë¸”)
    await supabase.from('deleted_users').insert({
        original_user_id: userId,
        deleted_at: new Date(),
        reason
    });

    // 3. Supabase Auth ê³„ì • ì‚­ì œ
    await supabaseAdmin.auth.admin.deleteUser(userId);

    // 4. ì¿ í‚¤ ì‚­ì œ ë° ë¡œê·¸ì•„ì›ƒ
    await supabase.auth.signOut();
}
```

### 2-5. ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ ë° ì´ìš©ì•½ê´€ í˜ì´ì§€
íŒŒì¼: /app/terms/page.tsx, /app/privacy/page.tsx (ìƒˆ íŒŒì¼)

ë²•ì  ìš”êµ¬ì‚¬í•­ì„ ì¶©ì¡±í•˜ê¸° ìœ„í•œ í˜ì´ì§€ë¥¼ ìƒì„±í•˜ì„¸ìš”:

1. ì´ìš©ì•½ê´€ (/terms):
   - ì„œë¹„ìŠ¤ ì´ìš© ê·œì¹™
   - ê¸ˆì§€ í–‰ìœ„
   - ë©´ì±… ì¡°í•­
   - ì„œë¹„ìŠ¤ ë³€ê²½/ì¤‘ë‹¨ ì•ˆë‚´

2. ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ (/privacy):
   - ìˆ˜ì§‘í•˜ëŠ” ì •ë³´ (ì´ë©”ì¼, ë‹‰ë„¤ì„, í”„ë¡œí•„ ì´ë¯¸ì§€, í™œë™ ë¡œê·¸)
   - ì •ë³´ ì‚¬ìš© ëª©ì 
   - ì •ë³´ ë³´ê´€ ê¸°ê°„
   - ì œ3ì ì œê³µ ì—¬ë¶€ (Supabase, Resend ë“±)
   - ì‚¬ìš©ì ê¶Œë¦¬ (ì—´ëŒ, ì •ì •, ì‚­ì œ ìš”ì²­)
   - ì¿ í‚¤ ì‚¬ìš©

Footerì— ë§í¬ ì¶”ê°€.

### 2-6. ê³„ì • ë³´ì•ˆ ì„¤ì •
íŒŒì¼: /app/mypage/security/page.tsx (ìƒˆ íŒŒì¼)

ë³´ì•ˆ ì„¤ì • í˜ì´ì§€ ì¶”ê°€:
1. ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ (ì´ë©”ì¼ ê°€ì…ìë§Œ):
   - í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ í™•ì¸
   - ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ (ê°•ë„ í‘œì‹œ)
   - Supabase `updateUser()` ì‚¬ìš©

2. ë¡œê·¸ì¸ ì„¸ì…˜ ê´€ë¦¬:
   - í˜„ì¬ í™œì„± ì„¸ì…˜ ëª©ë¡ (ê¸°ê¸°, ìœ„ì¹˜, ë§ˆì§€ë§‰ í™œë™ ì‹œê°„)
   - ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼

3. 2ë‹¨ê³„ ì¸ì¦ (í–¥í›„ í™•ì¥):
   - í˜„ì¬ëŠ” "ì¤€ë¹„ ì¤‘" ìƒíƒœë¡œ í‘œì‹œ

## ì˜ˆìƒ ê²°ê³¼
- ì‚¬ìš©ìê°€ ìì‹ ì˜ ì •ë³´ë¥¼ ì§ì ‘ ê´€ë¦¬ ê°€ëŠ¥
- ë²•ì  ë¦¬ìŠ¤í¬ ê°ì†Œ (ì´ìš©ì•½ê´€, ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨)
- ë‹¤ì–‘í•œ ê°€ì… ë°©ë²• ì œê³µìœ¼ë¡œ ì‚¬ìš©ì ìœ ì… ì¦ê°€
- íšŒì› ì´íƒˆ ì‹œ ë°ì´í„° ì™„ì „ ì‚­ì œë¡œ GDPR ì¤€ìˆ˜
```

---

## 3ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™” ë° ë³´ì•ˆ ê°•í™”

```
# ì‘ì—… ëª…: DB ì„±ëŠ¥ ë° ë³´ì•ˆ ê°œì„ 

## ë°°ê²½
í˜„ì¬ DBëŠ” ê¸°ë³¸ ìŠ¤í‚¤ë§ˆë§Œ ìˆê³  ë‹¤ìŒì´ ë¶€ì¡±í•©ë‹ˆë‹¤:
- ì¸ë±ìŠ¤ ìµœì í™”
- RLS(Row Level Security) ì •ì±… ë³´ì™„
- ê°ì‚¬ ë¡œê·¸ (ëˆ„ê°€ ì–¸ì œ ë¬´ì—‡ì„ í–ˆëŠ”ì§€)
- ë°ì´í„° ë°±ì—… ë° ë³µêµ¬ ì „ëµ

## ê°œì„  ì‘ì—…

### 3-1. ì¸ë±ìŠ¤ ì¶”ê°€
íŒŒì¼: supabase/migrations/001_add_indexes.sql (ìƒˆ íŒŒì¼)

ë‹¤ìŒ ì¸ë±ìŠ¤ë¥¼ ì¶”ê°€í•˜ì„¸ìš”:

```sql
-- courses í…Œì´ë¸” (ê²€ìƒ‰ ì¿¼ë¦¬ ìµœì í™”)
CREATE INDEX idx_courses_region ON courses(region);
CREATE INDEX idx_courses_institution ON courses(institution);
CREATE INDEX idx_courses_status ON courses(status);
CREATE INDEX idx_courses_created ON courses(created_at DESC);
CREATE INDEX idx_courses_title_gin ON courses USING gin(to_tsvector('korean', title)); -- ì „ë¬¸ ê²€ìƒ‰

-- bookmarks í…Œì´ë¸”
CREATE INDEX idx_bookmarks_user ON bookmarks(user_id);
CREATE INDEX idx_bookmarks_course ON bookmarks(course_id);
CREATE INDEX idx_bookmarks_user_created ON bookmarks(user_id, created_at DESC);

-- keywords í…Œì´ë¸”
CREATE INDEX idx_keywords_user ON keywords(user_id);
CREATE INDEX idx_keywords_word ON keywords(word);

-- notifications í…Œì´ë¸”
CREATE INDEX idx_notifications_user_read ON notifications(user_id, is_read);
CREATE INDEX idx_notifications_created ON notifications(created_at DESC);

-- push_subscriptions í…Œì´ë¸”
CREATE INDEX idx_push_user ON push_subscriptions(user_id);
```

### 3-2. RLS ì •ì±… ê°•í™”
íŒŒì¼: supabase/migrations/002_enhance_rls.sql (ìƒˆ íŒŒì¼)

```sql
-- bookmarks í…Œì´ë¸” RLS
ALTER TABLE bookmarks ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can view own bookmarks"
ON bookmarks FOR SELECT
USING (auth.uid() = user_id);

CREATE POLICY "Users can insert own bookmarks"
ON bookmarks FOR INSERT
WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can delete own bookmarks"
ON bookmarks FOR DELETE
USING (auth.uid() = user_id);

-- keywords í…Œì´ë¸” RLS
ALTER TABLE keywords ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can manage own keywords"
ON keywords FOR ALL
USING (auth.uid() = user_id);

-- notifications í…Œì´ë¸” RLS
ALTER TABLE notifications ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can view own notifications"
ON notifications FOR SELECT
USING (auth.uid() = user_id);

CREATE POLICY "Users can update own notifications"
ON notifications FOR UPDATE
USING (auth.uid() = user_id);

-- push_subscriptions í…Œì´ë¸” RLS
ALTER TABLE push_subscriptions ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can manage own push subscriptions"
ON push_subscriptions FOR ALL
USING (auth.uid() = user_id);

-- posts í…Œì´ë¸” RLS (ì»¤ë®¤ë‹ˆí‹°)
ALTER TABLE posts ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Anyone can view posts"
ON posts FOR SELECT
USING (true);

CREATE POLICY "Authenticated users can create posts"
ON posts FOR INSERT
WITH CHECK (auth.role() = 'authenticated' OR auth.role() = 'anon'); -- ë¹„ë¡œê·¸ì¸ë„ ê¸€ ì‘ì„± ê°€ëŠ¥

-- feedbacks í…Œì´ë¸” RLS
ALTER TABLE feedbacks ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can submit feedback"
ON feedbacks FOR INSERT
WITH CHECK (true);

CREATE POLICY "Only admins can view feedback"
ON feedbacks FOR SELECT
USING (auth.email() = 'devyongt@gmail.com'); -- ê´€ë¦¬ì ì´ë©”ì¼
```

### 3-3. ê°ì‚¬ ë¡œê·¸ ì‹œìŠ¤í…œ
íŒŒì¼: supabase/migrations/003_audit_log.sql (ìƒˆ íŒŒì¼)

```sql
-- ê°ì‚¬ ë¡œê·¸ í…Œì´ë¸”
CREATE TABLE audit_logs (
    id BIGSERIAL PRIMARY KEY,
    user_id UUID REFERENCES auth.users(id) ON DELETE SET NULL,
    action VARCHAR(100) NOT NULL, -- 'create', 'update', 'delete'
    table_name VARCHAR(50) NOT NULL,
    record_id TEXT,
    old_data JSONB,
    new_data JSONB,
    ip_address INET,
    user_agent TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),

    INDEX idx_audit_user (user_id),
    INDEX idx_audit_table (table_name),
    INDEX idx_audit_created (created_at DESC)
);

-- íŠ¸ë¦¬ê±° í•¨ìˆ˜ (ìë™ ê°ì‚¬ ë¡œê·¸ ê¸°ë¡)
CREATE OR REPLACE FUNCTION log_audit()
RETURNS TRIGGER AS $$
BEGIN
    IF TG_OP = 'DELETE' THEN
        INSERT INTO audit_logs (user_id, action, table_name, record_id, old_data)
        VALUES (auth.uid(), 'delete', TG_TABLE_NAME, OLD.id::TEXT, row_to_json(OLD));
        RETURN OLD;
    ELSIF TG_OP = 'UPDATE' THEN
        INSERT INTO audit_logs (user_id, action, table_name, record_id, old_data, new_data)
        VALUES (auth.uid(), 'update', TG_TABLE_NAME, NEW.id::TEXT, row_to_json(OLD), row_to_json(NEW));
        RETURN NEW;
    ELSIF TG_OP = 'INSERT' THEN
        INSERT INTO audit_logs (user_id, action, table_name, record_id, new_data)
        VALUES (auth.uid(), 'insert', TG_TABLE_NAME, NEW.id::TEXT, row_to_json(NEW));
        RETURN NEW;
    END IF;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- ì¤‘ìš” í…Œì´ë¸”ì— íŠ¸ë¦¬ê±° ì ìš©
CREATE TRIGGER audit_courses
AFTER INSERT OR UPDATE OR DELETE ON courses
FOR EACH ROW EXECUTE FUNCTION log_audit();

CREATE TRIGGER audit_bookmarks
AFTER INSERT OR UPDATE OR DELETE ON bookmarks
FOR EACH ROW EXECUTE FUNCTION log_audit();

-- (í•„ìš”í•œ í…Œì´ë¸”ì— ë™ì¼í•˜ê²Œ ì ìš©)
```

### 3-4. ë°ì´í„° ì •í•©ì„± ì œì•½ì¡°ê±´ ì¶”ê°€
íŒŒì¼: supabase/migrations/004_constraints.sql (ìƒˆ íŒŒì¼)

```sql
-- courses í…Œì´ë¸”ì— ì¶”ê°€ í•„ë“œ ë° ì œì•½ì¡°ê±´
ALTER TABLE courses
ADD COLUMN IF NOT EXISTS updated_at TIMESTAMPTZ DEFAULT NOW(),
ADD CONSTRAINT check_status CHECK (status IN ('ì ‘ìˆ˜ì¤‘', 'ë§ˆê°ì„ë°•', 'ë§ˆê°', 'ì ‘ìˆ˜ì˜ˆì •', 'ì ‘ìˆ˜ëŒ€ê¸°', 'ì¶”ê°€ì ‘ìˆ˜', 'ëª¨ì§‘ì¢…ë£Œ'));

-- updated_at ìë™ ì—…ë°ì´íŠ¸ íŠ¸ë¦¬ê±°
CREATE OR REPLACE FUNCTION update_updated_at()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = NOW();
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER set_updated_at
BEFORE UPDATE ON courses
FOR EACH ROW EXECUTE FUNCTION update_updated_at();

-- bookmarks ì¤‘ë³µ ë°©ì§€ (user + course ì¡°í•© ìœ ë‹ˆí¬)
ALTER TABLE bookmarks
ADD CONSTRAINT unique_user_course UNIQUE (user_id, course_id);

-- keywords ì¤‘ë³µ ë°©ì§€
ALTER TABLE keywords
ADD CONSTRAINT unique_user_word UNIQUE (user_id, word);
```

### 3-5. ë°ì´í„° ë°±ì—… ì „ëµ ë¬¸ì„œí™”
íŒŒì¼: /docs/database-backup.md (ìƒˆ íŒŒì¼)

Supabase ë°±ì—… ì „ëµì„ ë¬¸ì„œí™”í•˜ì„¸ìš”:

```markdown
# ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… ë° ë³µêµ¬ ì „ëµ

## ìë™ ë°±ì—… (Supabase ê¸°ë³¸ ì œê³µ)
- SupabaseëŠ” ë§¤ì¼ ìë™ ë°±ì—… ìˆ˜í–‰ (ìµœê·¼ 7ì¼ ë³´ê´€)
- Dashboard > Settings > Backupsì—ì„œ í™•ì¸ ê°€ëŠ¥
- Point-in-Time Recovery (PITR) í™œì„±í™” ê¶Œì¥ (Pro í”Œëœ ì´ìƒ)

## ìˆ˜ë™ ë°±ì—…
ì •ê¸°ì ìœ¼ë¡œ ì¤‘ìš” ë°ì´í„°ë¥¼ ë¡œì»¬ì— ë°±ì—…í•˜ì„¸ìš”:

```bash
# PostgreSQL dump ìƒì„±
pg_dump -h db.xxxx.supabase.co -U postgres -d postgres > backup_$(date +%Y%m%d).sql

# íŠ¹ì • í…Œì´ë¸”ë§Œ ë°±ì—…
pg_dump -h db.xxxx.supabase.co -U postgres -d postgres -t courses -t bookmarks > partial_backup.sql
```

## ë³µêµ¬ ì ˆì°¨
1. Supabase Dashboardì—ì„œ ë³µêµ¬ í¬ì¸íŠ¸ ì„ íƒ
2. ìƒˆ í”„ë¡œì íŠ¸ë¡œ ë³µì› (í…ŒìŠ¤íŠ¸ í›„ ì „í™˜)
3. ë˜ëŠ” SQL íŒŒì¼ë¡œ ë³µì›: `psql -h ... -U postgres -d postgres < backup.sql`

## ë°±ì—… ìŠ¤ì¼€ì¤„
- ë§¤ì¼ ìë™: Supabase
- ë§¤ì£¼ ìˆ˜ë™: ì¤‘ìš” í…Œì´ë¸” ë¡œì»¬ ë°±ì—…
- ë§¤ì›”: ì „ì²´ DB ë¤í”„ + ì™¸ë¶€ ì €ì¥ì†Œ(AWS S3 ë“±)ì— ë³´ê´€
```

## ì˜ˆìƒ ê²°ê³¼
- ì¿¼ë¦¬ ì„±ëŠ¥ ëŒ€í­ í–¥ìƒ (ì¸ë±ìŠ¤)
- ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥ (ì œì•½ì¡°ê±´)
- ë³´ì•ˆ ê°•í™” (RLS)
- ì¥ì•  ëŒ€ì‘ ëŠ¥ë ¥ í–¥ìƒ (ë°±ì—…/ë³µêµ¬)
- ê·œì œ ì¤€ìˆ˜ (ê°ì‚¬ ë¡œê·¸)
```

---

## 4ï¸âƒ£ ë³´ì•ˆ ì·¨ì•½ì  í•´ê²°

```
# ì‘ì—… ëª…: ë³´ì•ˆ ì·¨ì•½ì  ì œê±° ë° ê°•í™”

## ë°°ê²½
ë‹¤ìŒ ë³´ì•ˆ ì´ìŠˆë“¤ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤:
- ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œê¸€ ë¹„ë°€ë²ˆí˜¸ê°€ í‰ë¬¸ì¼ ê°€ëŠ¥ì„±
- Rate limiting ë¶€ì¬ (ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©, ìŠ¤íŒ¸ ë°©ì§€)
- CSRF í† í° ë¶€ì¬
- í™˜ê²½ë³€ìˆ˜ ì¼ë¶€ í•˜ë“œì½”ë”©
- XSS ì·¨ì•½ì  ê°€ëŠ¥ì„±

## ê°œì„  ì‘ì—…

### 4-1. ì»¤ë®¤ë‹ˆí‹° ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”
íŒŒì¼: /app/actions/community.ts

í˜„ì¬ posts í…Œì´ë¸”ì˜ password í•„ë“œ ì²˜ë¦¬ë¥¼ í™•ì¸í•˜ê³  ì•”í˜¸í™”í•˜ì„¸ìš”:

```typescript
import { hash, compare } from 'bcryptjs';

// ê²Œì‹œê¸€ ì‘ì„± ì‹œ
export async function createPost(formData: FormData) {
    const password = formData.get('password') as string;

    // bcryptë¡œ í•´ì‹± (saltRounds: 10)
    const hashedPassword = await hash(password, 10);

    const { data, error } = await supabase.from('posts').insert({
        title: formData.get('title'),
        content: formData.get('content'),
        password: hashedPassword, // í•´ì‹œ ì €ì¥
        nickname: formData.get('nickname'),
        tag: formData.get('tag'),
    });

    return { data, error };
}

// ê²Œì‹œê¸€ ì‚­ì œ ì‹œ ë¹„ë°€ë²ˆí˜¸ í™•ì¸
export async function deletePost(postId: string, inputPassword: string) {
    // 1. DBì—ì„œ ê²Œì‹œê¸€ ì¡°íšŒ
    const { data: post } = await supabase
        .from('posts')
        .select('password')
        .eq('id', postId)
        .single();

    if (!post) return { error: 'ê²Œì‹œê¸€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.' };

    // 2. ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
    const isValid = await compare(inputPassword, post.password);
    if (!isValid) return { error: 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.' };

    // 3. ì‚­ì œ
    const { error } = await supabase.from('posts').delete().eq('id', postId);
    return { error };
}
```

ì˜ì¡´ì„± ì¶”ê°€: `npm install bcryptjs @types/bcryptjs`

### 4-2. Rate Limiting êµ¬í˜„
íŒŒì¼: /lib/rate-limiter.ts (ìƒˆ íŒŒì¼)

Upstash Redis ë˜ëŠ” ê°„ë‹¨í•œ ë©”ëª¨ë¦¬ ê¸°ë°˜ Rate Limiterë¥¼ êµ¬í˜„í•˜ì„¸ìš”:

```typescript
// ë©”ëª¨ë¦¬ ê¸°ë°˜ ê°„ë‹¨í•œ Rate Limiter (ê°œë°œ/ì†Œê·œëª¨ìš©)
const requests = new Map<string, { count: number; resetAt: number }>();

export function checkRateLimit(
    identifier: string, // IP ì£¼ì†Œ ë˜ëŠ” user ID
    maxRequests: number, // í—ˆìš© íšŸìˆ˜
    windowMs: number // ì‹œê°„ ì°½ (ë°€ë¦¬ì´ˆ)
): { allowed: boolean; remaining: number; resetAt: number } {
    const now = Date.now();
    const record = requests.get(identifier);

    if (!record || now > record.resetAt) {
        // ìƒˆ ìœˆë„ìš° ì‹œì‘
        const resetAt = now + windowMs;
        requests.set(identifier, { count: 1, resetAt });
        return { allowed: true, remaining: maxRequests - 1, resetAt };
    }

    if (record.count >= maxRequests) {
        // í•œë„ ì´ˆê³¼
        return { allowed: false, remaining: 0, resetAt: record.resetAt };
    }

    // ì¹´ìš´íŠ¸ ì¦ê°€
    record.count++;
    return { allowed: true, remaining: maxRequests - record.count, resetAt: record.resetAt };
}

// ì£¼ê¸°ì ìœ¼ë¡œ ë§Œë£Œëœ í•­ëª© ì •ë¦¬
setInterval(() => {
    const now = Date.now();
    for (const [key, value] of requests.entries()) {
        if (now > value.resetAt) {
            requests.delete(key);
        }
    }
}, 60000); // 1ë¶„ë§ˆë‹¤
```

íŒŒì¼: /middleware.ts
ë¯¸ë“¤ì›¨ì–´ì— Rate Limiting ì ìš©:

```typescript
import { checkRateLimit } from '@/lib/rate-limiter';

export async function middleware(request: NextRequest) {
    // API ë¼ìš°íŠ¸ì—ë§Œ ì ìš©
    if (request.nextUrl.pathname.startsWith('/api/')) {
        const ip = request.headers.get('x-forwarded-for') || request.ip || 'unknown';
        const { allowed, remaining, resetAt } = checkRateLimit(ip, 100, 60000); // ë¶„ë‹¹ 100íšŒ

        if (!allowed) {
            return new NextResponse('Too Many Requests', {
                status: 429,
                headers: {
                    'Retry-After': String(Math.ceil((resetAt - Date.now()) / 1000)),
                    'X-RateLimit-Remaining': '0',
                },
            });
        }

        const response = NextResponse.next({ request: { headers: request.headers } });
        response.headers.set('X-RateLimit-Remaining', String(remaining));
        return response;
    }

    // ê¸°ì¡´ ë¡œì§...
}
```

### 4-3. CSRF ë³´í˜¸ ê°•í™”
íŒŒì¼: /lib/csrf.ts (ìƒˆ íŒŒì¼)

Next.jsëŠ” ê¸°ë³¸ì ìœ¼ë¡œ CSRF ë³´í˜¸ê°€ ë˜ì§€ë§Œ, ë¯¼ê°í•œ ì‘ì—…ì—ëŠ” ì¶”ê°€ í† í°ì„ ì‚¬ìš©í•˜ì„¸ìš”:

```typescript
import { cookies } from 'next/headers';
import crypto from 'crypto';

export function generateCSRFToken(): string {
    return crypto.randomBytes(32).toString('hex');
}

export async function setCSRFToken(): Promise<string> {
    const token = generateCSRFToken();
    (await cookies()).set('csrf-token', token, {
        httpOnly: true,
        secure: process.env.NODE_ENV === 'production',
        sameSite: 'strict',
        maxAge: 60 * 60 * 24, // 1ì¼
    });
    return token;
}

export async function verifyCSRFToken(token: string): Promise<boolean> {
    const storedToken = (await cookies()).get('csrf-token')?.value;
    return storedToken === token && token.length === 64;
}
```

íŒŒì¼: /app/actions/*.ts
ëª¨ë“  ì„œë²„ ì•¡ì…˜ì— CSRF ê²€ì¦ ì¶”ê°€:

```typescript
export async function deletePost(formData: FormData) {
    const csrfToken = formData.get('csrf-token') as string;
    if (!await verifyCSRFToken(csrfToken)) {
        return { error: 'Invalid CSRF token' };
    }

    // ê¸°ì¡´ ë¡œì§...
}
```

### 4-4. XSS ë°©ì§€
íŒŒì¼: ëª¨ë“  ì‚¬ìš©ì ì…ë ¥ì„ í‘œì‹œí•˜ëŠ” ì»´í¬ë„ŒíŠ¸

ReactëŠ” ê¸°ë³¸ì ìœ¼ë¡œ XSSë¥¼ ë°©ì–´í•˜ì§€ë§Œ, `dangerouslySetInnerHTML`ì„ ì‚¬ìš©í•˜ëŠ” ê³³ì´ ìˆë‹¤ë©´ ì œê±°í•˜ì„¸ìš”.

ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œê¸€ ë“±ì—ì„œ ì‚¬ìš©ì ì…ë ¥ì„ ë Œë”ë§í•  ë•Œ:

```typescript
import DOMPurify from 'isomorphic-dompurify';

// ì‚¬ìš©ì ì…ë ¥ sanitize
const cleanContent = DOMPurify.sanitize(post.content, {
    ALLOWED_TAGS: ['b', 'i', 'em', 'strong', 'a', 'br', 'p'],
    ALLOWED_ATTR: ['href']
});

// ë Œë”ë§
<div dangerouslySetInnerHTML={{ __html: cleanContent }} />
```

ì˜ì¡´ì„±: `npm install isomorphic-dompurify`

ë˜ëŠ” ë” ê°„ë‹¨í•˜ê²Œ, HTMLì„ í—ˆìš©í•˜ì§€ ì•Šê³  ì¼ë°˜ í…ìŠ¤íŠ¸ë§Œ í‘œì‹œ:
```typescript
<p className="whitespace-pre-wrap">{post.content}</p>
```

### 4-5. í™˜ê²½ë³€ìˆ˜ í•˜ë“œì½”ë”© ì œê±°
íŒŒì¼: /app/api/kakao-callback/route.ts, /middleware.ts ë“±

ì½”ë“œì— í•˜ë“œì½”ë”©ëœ ê°’ë“¤ì„ í™˜ê²½ë³€ìˆ˜ë¡œ ì´ë™:

```typescript
// âŒ í•˜ë“œì½”ë”© (í˜„ì¬)
const ADMIN_EMAIL = "devyongt@gmail.com";
const KAKAO_CLIENT_ID = "b6a8f2791cd23f7995b4fba26c649c20";

// âœ… í™˜ê²½ë³€ìˆ˜ë¡œ ì´ë™
const ADMIN_EMAIL = process.env.ADMIN_EMAIL;
const KAKAO_CLIENT_ID = process.env.KAKAO_CLIENT_ID;

if (!ADMIN_EMAIL || !KAKAO_CLIENT_ID) {
    throw new Error('Missing required environment variables');
}
```

.env.local.example íŒŒì¼ ìƒì„±:
```
# Admin
ADMIN_EMAIL=your-email@example.com

# Kakao OAuth
KAKAO_CLIENT_ID=your-client-id
KAKAO_CLIENT_SECRET=your-client-secret

# ... (ê¸°íƒ€ í™˜ê²½ë³€ìˆ˜)
```

### 4-6. ë³´ì•ˆ í—¤ë” ì¶”ê°€
íŒŒì¼: /next.config.ts

Next.js ì„¤ì •ì— ë³´ì•ˆ í—¤ë” ì¶”ê°€:

```typescript
const nextConfig = {
    // ê¸°ì¡´ ì„¤ì •...

    async headers() {
        return [
            {
                source: '/(.*)',
                headers: [
                    {
                        key: 'X-Frame-Options',
                        value: 'DENY',
                    },
                    {
                        key: 'X-Content-Type-Options',
                        value: 'nosniff',
                    },
                    {
                        key: 'Referrer-Policy',
                        value: 'strict-origin-when-cross-origin',
                    },
                    {
                        key: 'Permissions-Policy',
                        value: 'camera=(), microphone=(), geolocation=()',
                    },
                ],
            },
        ];
    },
};
```

## ì˜ˆìƒ ê²°ê³¼
- ë¹„ë°€ë²ˆí˜¸ íƒˆì·¨ ì‹œì—ë„ í‰ë¬¸ ë…¸ì¶œ ë°©ì§€
- ìë™í™” ê³µê²©(ë´‡, ìŠ¤í¬ë˜í•‘) ì°¨ë‹¨
- CSRF ê³µê²© ë°©ì–´
- ë¯¼ê° ì •ë³´ ìœ ì¶œ ë°©ì§€
- XSS ê³µê²© ì°¨ë‹¨
```

---

## 5ï¸âƒ£ ì„±ëŠ¥ ìµœì í™”

```
# ì‘ì—… ëª…: í”„ë¡ íŠ¸ì—”ë“œ ë° ë°±ì—”ë“œ ì„±ëŠ¥ ê°œì„ 

## ë°°ê²½
ë‹¤ìŒ ì„±ëŠ¥ ì´ìŠˆê°€ ìˆìŠµë‹ˆë‹¤:
- N+1 ì¿¼ë¦¬ ë¬¸ì œ (ì°œ ì—¬ë¶€ í™•ì¸ ì‹œ)
- ìºì‹± ì „ëµ ë¶€ì¬
- ì´ë¯¸ì§€ ìµœì í™” ë¶€ì¡±
- í˜ì´ì§€ë„¤ì´ì…˜ ëŒ€ì‹  ë¬´í•œ ìŠ¤í¬ë¡¤ í•„ìš”

## ê°œì„  ì‘ì—…

### 5-1. N+1 ì¿¼ë¦¬ í•´ê²°
íŒŒì¼: /lib/db-api.ts

í˜„ì¬ `getPaginatedCourses` í•¨ìˆ˜ëŠ” ì°œ ì—¬ë¶€ë¥¼ ë³„ë„ ì¿¼ë¦¬ë¡œ í™•ì¸í•©ë‹ˆë‹¤. ì´ë¥¼ ë‹¨ì¼ ì¿¼ë¦¬ë¡œ ìµœì í™”:

```typescript
// âŒ ê¸°ì¡´ (N+1 ë¬¸ì œ)
// 1. ê°•ì¢Œ ëª©ë¡ ì¡°íšŒ
const courses = await getCourses();
// 2. ê° ê°•ì¢Œë§ˆë‹¤ ì°œ ì—¬ë¶€ í™•ì¸
for (const course of courses) {
    const isBookmarked = await checkBookmark(course.id, userId);
}

// âœ… ê°œì„  (ë‹¨ì¼ ì¿¼ë¦¬)
export async function getPaginatedCourses(...) {
    // ê°•ì¢Œ ëª©ë¡ ì¡°íšŒ (ê¸°ì¡´ê³¼ ë™ì¼)
    const { data: coursesData } = await query...;

    if (!userId) return coursesData.map(mapRawToCourse);

    // ì°œ ëª©ë¡ì„ í•œ ë²ˆì— ì¡°íšŒ
    const courseIds = coursesData.map(c => c.id);
    const { data: bookmarks } = await supabase
        .from('bookmarks')
        .select('course_id')
        .eq('user_id', userId)
        .in('course_id', courseIds);

    const bookmarkedSet = new Set(bookmarks?.map(b => b.course_id) || []);

    // ë§¤í•‘
    return coursesData.map(c => ({
        ...mapRawToCourse(c),
        isBookmarked: bookmarkedSet.has(c.id)
    }));
}
```

ì´ë¯¸ êµ¬í˜„ë˜ì–´ ìˆë‹¤ë©´ í™•ì¸ë§Œ í•˜ì„¸ìš”.

### 5-2. React Query ë„ì… (ìºì‹±)
íŒŒì¼: /app/providers.tsx (ìƒˆ íŒŒì¼)

React Queryë¥¼ ë„ì…í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ìºì‹± ë° ìƒíƒœ ê´€ë¦¬ë¥¼ ê°œì„ :

```bash
npm install @tanstack/react-query
```

```typescript
'use client';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { ReactNode, useState } from 'react';

export function Providers({ children }: { children: ReactNode }) {
    const [queryClient] = useState(() => new QueryClient({
        defaultOptions: {
            queries: {
                staleTime: 60 * 1000, // 1ë¶„
                cacheTime: 5 * 60 * 1000, // 5ë¶„
                refetchOnWindowFocus: false,
            },
        },
    }));

    return (
        <QueryClientProvider client={queryClient}>
            {children}
        </QueryClientProvider>
    );
}
```

íŒŒì¼: /app/layout.tsx
```typescript
import { Providers } from './providers';

export default function RootLayout({ children }) {
    return (
        <html>
            <body>
                <Providers>
                    {children}
                </Providers>
            </body>
        </html>
    );
}
```

íŒŒì¼: /components/CourseExplorer.tsx
React Queryë¡œ ê°•ì¢Œ ëª©ë¡ ì¡°íšŒ:

```typescript
import { useQuery } from '@tanstack/react-query';

export default function CourseExplorer() {
    const { data: courses, isLoading } = useQuery({
        queryKey: ['courses', page, filters],
        queryFn: () => fetchCourses(page, filters),
        keepPreviousData: true, // í˜ì´ì§€ ì „í™˜ ì‹œ ì´ì „ ë°ì´í„° ìœ ì§€
    });

    // ë Œë”ë§...
}
```

### 5-3. Next.js ISR (Incremental Static Regeneration) í™œìš©
íŒŒì¼: /app/page.tsx, /app/courses/[id]/page.tsx

ì •ì  ìƒì„± + ì£¼ê¸°ì  ì¬ìƒì„±ìœ¼ë¡œ ì„±ëŠ¥ ê°œì„ :

```typescript
// ë©”ì¸ í˜ì´ì§€
export const revalidate = 300; // 5ë¶„ë§ˆë‹¤ ì¬ìƒì„±

export default async function HomePage() {
    const courses = await getRecommendedCourses();
    return <div>...</div>;
}

// ê°•ì¢Œ ìƒì„¸ í˜ì´ì§€
export const revalidate = 600; // 10ë¶„ë§ˆë‹¤ ì¬ìƒì„±

export async function generateStaticParams() {
    // ì¸ê¸° ê°•ì¢Œ 100ê°œë§Œ ë¹Œë“œ ì‹œ ë¯¸ë¦¬ ìƒì„±
    const { data } = await supabase
        .from('courses')
        .select('id')
        .limit(100);

    return data?.map(c => ({ id: c.id.toString() })) || [];
}

export default async function CoursePage({ params }: { params: { id: string } }) {
    const course = await getCourseById(params.id);
    return <div>...</div>;
}
```

### 5-4. ì´ë¯¸ì§€ ìµœì í™”
íŒŒì¼: /components/CourseCard.tsx, /app/courses/[id]/page.tsx

Next.js Image ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©:

```typescript
import Image from 'next/image';

// âŒ ê¸°ì¡´
<img src={course.imageUrl} alt={course.title} />

// âœ… ê°œì„ 
<Image
    src={course.imageUrl}
    alt={course.title}
    width={800}
    height={600}
    placeholder="blur"
    blurDataURL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mN8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg=="
    className="rounded-lg"
    priority={index < 4} // ìƒìœ„ 4ê°œë§Œ ìš°ì„  ë¡œë“œ
/>
```

íŒŒì¼: /next.config.ts
ì™¸ë¶€ ì´ë¯¸ì§€ ë„ë©”ì¸ í—ˆìš©:

```typescript
const nextConfig = {
    images: {
        domains: ['images.unsplash.com', 'via.placeholder.com', 'placehold.co'],
        formats: ['image/avif', 'image/webp'],
    },
};
```

### 5-5. ë¬´í•œ ìŠ¤í¬ë¡¤ êµ¬í˜„
íŒŒì¼: /components/CourseExplorer.tsx

ê¸°ì¡´ í˜ì´ì§€ë„¤ì´ì…˜ ëŒ€ì‹  ë¬´í•œ ìŠ¤í¬ë¡¤:

```typescript
import { useInfiniteQuery } from '@tanstack/react-query';
import { useInView } from 'react-intersection-observer';

export default function CourseExplorer() {
    const {
        data,
        fetchNextPage,
        hasNextPage,
        isFetchingNextPage,
    } = useInfiniteQuery({
        queryKey: ['courses', filters],
        queryFn: ({ pageParam = 1 }) => fetchCourses(pageParam, 20, filters),
        getNextPageParam: (lastPage, pages) => {
            if (lastPage.length < 20) return undefined; // ë§ˆì§€ë§‰ í˜ì´ì§€
            return pages.length + 1;
        },
    });

    const { ref, inView } = useInView();

    useEffect(() => {
        if (inView && hasNextPage) {
            fetchNextPage();
        }
    }, [inView, hasNextPage, fetchNextPage]);

    return (
        <div>
            {data?.pages.map((page, i) => (
                <React.Fragment key={i}>
                    {page.map(course => <CourseCard key={course.id} course={course} />)}
                </React.Fragment>
            ))}

            {/* ì„¼í‹°ë„ ìš”ì†Œ (í™”ë©´ì— ë³´ì´ë©´ ë‹¤ìŒ í˜ì´ì§€ ë¡œë“œ) */}
            <div ref={ref} className="h-10">
                {isFetchingNextPage && <LoadingSpinner />}
            </div>
        </div>
    );
}
```

ì˜ì¡´ì„±: `npm install react-intersection-observer`

### 5-6. ì½”ë“œ ìŠ¤í”Œë¦¬íŒ… ë° ì§€ì—° ë¡œë”©
íŒŒì¼: ë¬´ê±°ìš´ ì»´í¬ë„ŒíŠ¸ë“¤

```typescript
import dynamic from 'next/dynamic';

// ì§€ë„ëŠ” ì‚¬ìš©ìê°€ ìƒì„¸ í˜ì´ì§€ì— ë“¤ì–´ì˜¬ ë•Œë§Œ ë¡œë“œ
const KakaoMap = dynamic(() => import('@/components/KakaoMap'), {
    ssr: false, // ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§ ë¹„í™œì„±í™”
    loading: () => <div>ì§€ë„ ë¡œë”© ì¤‘...</div>,
});

// ì»¤ë®¤ë‹ˆí‹° ê¸€ì“°ê¸° ëª¨ë‹¬ë„ í•„ìš”í•  ë•Œë§Œ ë¡œë“œ
const WritePostModal = dynamic(() => import('@/components/WritePostModal'));
```

### 5-7. DB ì¿¼ë¦¬ ê²°ê³¼ ìºì‹± (ì„œë²„ ì‚¬ì´ë“œ)
íŒŒì¼: /lib/cache.ts (ìƒˆ íŒŒì¼)

ê°„ë‹¨í•œ ë©”ëª¨ë¦¬ ìºì‹œ:

```typescript
interface CacheEntry<T> {
    data: T;
    expiresAt: number;
}

const cache = new Map<string, CacheEntry<any>>();

export async function cachedQuery<T>(
    key: string,
    fetcher: () => Promise<T>,
    ttlSeconds: number = 60
): Promise<T> {
    const now = Date.now();
    const cached = cache.get(key);

    if (cached && now < cached.expiresAt) {
        return cached.data;
    }

    const data = await fetcher();
    cache.set(key, {
        data,
        expiresAt: now + ttlSeconds * 1000,
    });

    return data;
}

// ì‚¬ìš© ì˜ˆ
export async function getFilterMetadata() {
    return cachedQuery(
        'filter-metadata',
        () => supabase.from('courses').select('region, institution'),
        300 // 5ë¶„ ìºì‹œ
    );
}
```

## ì˜ˆìƒ ê²°ê³¼
- í˜ì´ì§€ ë¡œë“œ ì†ë„ 50% í–¥ìƒ
- ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ìˆ˜ 70% ê°ì†Œ
- ì´ë¯¸ì§€ ë¡œë”© ì‹œê°„ ë‹¨ì¶•
- ë” ë¶€ë“œëŸ¬ìš´ UX (ë¬´í•œ ìŠ¤í¬ë¡¤)
- ì„œë²„ ë¹„ìš© ì ˆê° (ìºì‹±)
```

---

## 6ï¸âƒ£ ì‚¬ìš©ì ê²½í—˜(UX) ê°œì„ 

```
# ì‘ì—… ëª…: UX ê°œì„  ë° ì ‘ê·¼ì„± ê°•í™”

## ë°°ê²½
ë‹¤ìŒ UX ì´ìŠˆê°€ ìˆìŠµë‹ˆë‹¤:
- ì—ëŸ¬ ë©”ì‹œì§€ ì¼ê´€ì„± ë¶€ì¡±
- ë¡œë”© ìƒíƒœ í‘œì‹œ ë¯¸í¡
- ëª¨ë°”ì¼ ë°˜ì‘í˜• ë””ìì¸ ê°œì„  ì—¬ì§€
- í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ ë° ìŠ¤í¬ë¦° ë¦¬ë” ì§€ì› ë¶€ì¡±

## ê°œì„  ì‘ì—…

### 6-1. ì „ì—­ Toast ì‹œìŠ¤í…œ êµ¬í˜„
íŒŒì¼: /components/Toast.tsx (ìƒˆ íŒŒì¼)

ì¼ê´€ëœ ì•Œë¦¼ ë©”ì‹œì§€ í‘œì‹œ:

```bash
npm install react-hot-toast
```

```typescript
'use client';
import { Toaster, toast } from 'react-hot-toast';

export function ToastProvider() {
    return (
        <Toaster
            position="top-center"
            toastOptions={{
                duration: 4000,
                style: {
                    background: '#1f2937',
                    color: '#fff',
                },
                success: {
                    icon: 'ğŸŠ',
                },
                error: {
                    icon: 'âŒ',
                },
            }}
        />
    );
}

// ì‚¬ìš© ì˜ˆ
import { toast } from 'react-hot-toast';

toast.success('ì°œ ëª©ë¡ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!');
toast.error('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
toast.loading('ì²˜ë¦¬ ì¤‘...');
```

íŒŒì¼: /app/layout.tsx
```typescript
import { ToastProvider } from '@/components/Toast';

export default function RootLayout({ children }) {
    return (
        <html>
            <body>
                {children}
                <ToastProvider />
            </body>
        </html>
    );
}
```

ëª¨ë“  `alert()` í˜¸ì¶œì„ `toast()`ë¡œ êµì²´í•˜ì„¸ìš”.

### 6-2. ì „ì—­ ë¡œë”© ìƒíƒœ ê´€ë¦¬
íŒŒì¼: /components/GlobalLoadingBar.tsx (ìƒˆ íŒŒì¼)

í˜ì´ì§€ ì „í™˜ ì‹œ ì§„í–‰ ìƒíƒœ í‘œì‹œ:

```bash
npm install nprogress
```

```typescript
'use client';
import { useEffect } from 'react';
import { usePathname, useSearchParams } from 'next/navigation';
import NProgress from 'nprogress';
import 'nprogress/nprogress.css';

NProgress.configure({ showSpinner: false });

export function GlobalLoadingBar() {
    const pathname = usePathname();
    const searchParams = useSearchParams();

    useEffect(() => {
        NProgress.done();
    }, [pathname, searchParams]);

    useEffect(() => {
        const handleStart = () => NProgress.start();
        const handleComplete = () => NProgress.done();

        // Next.js ë¼ìš°íŠ¸ ë³€ê²½ ì´ë²¤íŠ¸ (App Routerì—ì„œëŠ” ìˆ˜ë™ ì²˜ë¦¬ í•„ìš”)
        window.addEventListener('beforeunload', handleStart);

        return () => {
            window.removeEventListener('beforeunload', handleStart);
        };
    }, []);

    return null;
}
```

íŒŒì¼: /app/layout.tsxì— ì¶”ê°€.

### 6-3. ìŠ¤ì¼ˆë ˆí†¤ ë¡œë”© UI
íŒŒì¼: /components/Skeleton.tsx (ìƒˆ íŒŒì¼)

ë¡œë”© ì¤‘ ìŠ¤ì¼ˆë ˆí†¤ í‘œì‹œ:

```typescript
export function CourseSkeleton() {
    return (
        <div className="bg-white rounded-2xl p-6 shadow-sm border border-gray-100 animate-pulse">
            <div className="h-48 bg-gray-200 rounded-lg mb-4"></div>
            <div className="h-6 bg-gray-200 rounded mb-2"></div>
            <div className="h-4 bg-gray-200 rounded w-2/3"></div>
        </div>
    );
}

export function SkeletonList({ count = 6 }: { count?: number }) {
    return (
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {Array.from({ length: count }).map((_, i) => (
                <CourseSkeleton key={i} />
            ))}
        </div>
    );
}
```

íŒŒì¼: /app/page.tsx
```typescript
import { Suspense } from 'react';
import { SkeletonList } from '@/components/Skeleton';

export default function HomePage() {
    return (
        <Suspense fallback={<SkeletonList />}>
            <CourseList />
        </Suspense>
    );
}
```

### 6-4. ë°˜ì‘í˜• ë””ìì¸ ê°œì„ 
íŒŒì¼: ëª¨ë“  ì»´í¬ë„ŒíŠ¸

Tailwind ë°˜ì‘í˜• í´ë˜ìŠ¤ í™•ì¸ ë° ê°œì„ :

```typescript
// âŒ ëª¨ë°”ì¼ì—ì„œ ì˜ë¦¼
<div className="grid grid-cols-3 gap-4">

// âœ… ëª¨ë°”ì¼ 1ì—´, íƒœë¸”ë¦¿ 2ì—´, ë°ìŠ¤í¬í†± 3ì—´
<div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">

// âŒ ëª¨ë°”ì¼ì—ì„œ í…ìŠ¤íŠ¸ ë„ˆë¬´ í¼
<h1 className="text-4xl font-bold">

// âœ… ë°˜ì‘í˜• í…ìŠ¤íŠ¸
<h1 className="text-2xl sm:text-3xl lg:text-4xl font-bold">

// âŒ ëª¨ë°”ì¼ì—ì„œ íŒ¨ë”© ê³¼ë„
<div className="px-8 py-12">

// âœ… ë°˜ì‘í˜• íŒ¨ë”©
<div className="px-4 sm:px-6 lg:px-8 py-6 sm:py-8 lg:py-12">
```

íŠ¹íˆ NotificationModal, LoginModal ë“± ëª¨ë‹¬ë“¤ì˜ ëª¨ë°”ì¼ ëŒ€ì‘ í™•ì¸.

### 6-5. ì ‘ê·¼ì„±(A11y) ê°œì„ 
íŒŒì¼: ëª¨ë“  ì¸í„°ë™í‹°ë¸Œ ì»´í¬ë„ŒíŠ¸

ARIA ì†ì„± ë° ì‹œë§¨í‹± HTML ì¶”ê°€:

```typescript
// âŒ ì ‘ê·¼ì„± ë¶€ì¡±
<div onClick={handleClick}>í´ë¦­</div>

// âœ… ë²„íŠ¼ìœ¼ë¡œ ë³€ê²½ + í‚¤ë³´ë“œ ì§€ì›
<button
    onClick={handleClick}
    onKeyDown={(e) => e.key === 'Enter' && handleClick()}
    aria-label="ê°•ì¢Œ ì°œí•˜ê¸°"
    className="..."
>
    í´ë¦­
</button>

// âŒ ì´ë¯¸ì§€ alt ëˆ„ë½
<img src="..." />

// âœ… alt ì¶”ê°€
<img src="..." alt="ìˆ˜ì˜ ê°•ì¢Œ ì¸ë„¤ì¼" />

// âŒ í¼ ë¼ë²¨ ì—†ìŒ
<input type="text" placeholder="ê²€ìƒ‰" />

// âœ… ë¼ë²¨ ì¶”ê°€
<label htmlFor="search" className="sr-only">ê°•ì¢Œ ê²€ìƒ‰</label>
<input id="search" type="text" placeholder="ê²€ìƒ‰" />

// ëª¨ë‹¬ ì ‘ê·¼ì„±
<div
    role="dialog"
    aria-modal="true"
    aria-labelledby="modal-title"
>
    <h2 id="modal-title">ë¡œê·¸ì¸</h2>
    ...
</div>
```

íŒŒì¼: /tailwind.config.ts
ìŠ¤í¬ë¦° ë¦¬ë” ì „ìš© í´ë˜ìŠ¤ ì¶”ê°€:

```typescript
module.exports = {
    theme: {
        extend: {
            // ê¸°ì¡´ ì„¤ì •...
        },
    },
    plugins: [
        function({ addUtilities }) {
            addUtilities({
                '.sr-only': {
                    position: 'absolute',
                    width: '1px',
                    height: '1px',
                    padding: '0',
                    margin: '-1px',
                    overflow: 'hidden',
                    clip: 'rect(0, 0, 0, 0)',
                    whiteSpace: 'nowrap',
                    borderWidth: '0',
                },
            });
        },
    ],
};
```

### 6-6. í¼ ìœ íš¨ì„± ê²€ì‚¬ ê°œì„ 
íŒŒì¼: /components/WritePostModal.tsx, /components/LoginModal.tsx ë“±

React Hook Form + Zodë¡œ í¼ ê´€ë¦¬:

```bash
npm install react-hook-form zod @hookform/resolvers
```

```typescript
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { z } from 'zod';

const postSchema = z.object({
    title: z.string().min(2, 'ì œëª©ì€ 2ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.').max(100, 'ì œëª©ì€ 100ì ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.'),
    content: z.string().min(10, 'ë‚´ìš©ì€ 10ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.'),
    password: z.string().min(4, 'ë¹„ë°€ë²ˆí˜¸ëŠ” 4ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.'),
    nickname: z.string().min(2, 'ë‹‰ë„¤ì„ì€ 2ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.'),
    tag: z.string(),
});

type PostForm = z.infer<typeof postSchema>;

export default function WritePostModal() {
    const {
        register,
        handleSubmit,
        formState: { errors, isSubmitting },
    } = useForm<PostForm>({
        resolver: zodResolver(postSchema),
    });

    const onSubmit = async (data: PostForm) => {
        // ì œì¶œ ë¡œì§...
        toast.success('ê²Œì‹œê¸€ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
    };

    return (
        <form onSubmit={handleSubmit(onSubmit)}>
            <div>
                <input {...register('title')} placeholder="ì œëª©" />
                {errors.title && <p className="text-red-500 text-sm">{errors.title.message}</p>}
            </div>

            <div>
                <textarea {...register('content')} placeholder="ë‚´ìš©" />
                {errors.content && <p className="text-red-500 text-sm">{errors.content.message}</p>}
            </div>

            <button type="submit" disabled={isSubmitting}>
                {isSubmitting ? 'ì‘ì„± ì¤‘...' : 'ì‘ì„±í•˜ê¸°'}
            </button>
        </form>
    );
}
```

### 6-7. ë¹ˆ ìƒíƒœ(Empty State) ê°œì„ 
íŒŒì¼: ë°ì´í„°ê°€ ì—†ì„ ë•Œ í‘œì‹œë˜ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸

í˜„ì¬ "ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤" ë©”ì‹œì§€ë¥¼ ë” ì¹œê·¼í•˜ê³  ì•¡ì…˜ ê°€ëŠ¥í•˜ê²Œ:

```typescript
// âŒ ê¸°ì¡´
{courses.length === 0 && <p>ê°•ì¢Œê°€ ì—†ìŠµë‹ˆë‹¤.</p>}

// âœ… ê°œì„ 
{courses.length === 0 && (
    <div className="flex flex-col items-center justify-center py-20 px-4 text-center">
        <div className="w-20 h-20 bg-orange-50 rounded-full flex items-center justify-center mb-4">
            <FolderOpen className="w-10 h-10 text-orange-400" />
        </div>
        <h3 className="text-xl font-bold text-gray-800 mb-2">
            ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ì–´ìš”
        </h3>
        <p className="text-gray-500 mb-6">
            ë‹¤ë¥¸ í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•´ë³´ì‹œê±°ë‚˜<br />
            í•„í„° ì¡°ê±´ì„ ë³€ê²½í•´ë³´ì„¸ìš”.
        </p>
        <button
            onClick={resetFilters}
            className="bg-orange-500 text-white px-6 py-3 rounded-xl font-bold hover:bg-orange-600"
        >
            í•„í„° ì´ˆê¸°í™”
        </button>
    </div>
)}
```

## ì˜ˆìƒ ê²°ê³¼
- ì¼ê´€ëœ ì‚¬ìš©ì ê²½í—˜
- ì‹œê°ì  í”¼ë“œë°± ì¦ê°€ (ë¡œë”©, ì„±ê³µ/ì‹¤íŒ¨)
- ëª¨ë°”ì¼ ì‚¬ìš©ì„± í–¥ìƒ
- ì¥ì• ì¸ ì‚¬ìš©ìë„ ì ‘ê·¼ ê°€ëŠ¥
- í¼ ì…ë ¥ ì˜¤ë¥˜ ê°ì†Œ
```

---

## 7ï¸âƒ£ í…ŒìŠ¤íŠ¸ ë° ëª¨ë‹ˆí„°ë§

```
# ì‘ì—… ëª…: í…ŒìŠ¤íŠ¸ ì¸í”„ë¼ êµ¬ì¶• ë° ëª¨ë‹ˆí„°ë§ ì„¤ì •

## ë°°ê²½
í˜„ì¬ í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ ì „í˜€ ì—†ìœ¼ë©°, ì—ëŸ¬ ì¶”ì  ì‹œìŠ¤í…œë„ ë¶€ì¬í•©ë‹ˆë‹¤.
ìƒìš© ì„œë¹„ìŠ¤ëŠ” ë°˜ë“œì‹œ í…ŒìŠ¤íŠ¸ ë° ëª¨ë‹ˆí„°ë§ì´ í•„ìš”í•©ë‹ˆë‹¤.

## ê°œì„  ì‘ì—…

### 7-1. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì„¤ì •
íŒŒì¼: jest.config.js (ìƒˆ íŒŒì¼)

```bash
npm install -D jest @testing-library/react @testing-library/jest-dom @testing-library/user-event jest-environment-jsdom
```

```javascript
const nextJest = require('next/jest');

const createJestConfig = nextJest({
    dir: './',
});

const customJestConfig = {
    setupFilesAfterEnv: ['<rootDir>/jest.setup.js'],
    testEnvironment: 'jest-environment-jsdom',
    moduleNameMapper: {
        '^@/(.*)$': '<rootDir>/$1',
    },
    testMatch: ['**/__tests__/**/*.test.{ts,tsx}'],
};

module.exports = createJestConfig(customJestConfig);
```

íŒŒì¼: jest.setup.js
```javascript
import '@testing-library/jest-dom';
```

íŒŒì¼: __tests__/components/BookmarkButton.test.tsx (ì˜ˆì‹œ)
```typescript
import { render, screen, fireEvent, waitFor } from '@testing-library/react';
import BookmarkButton from '@/components/BookmarkButton';

jest.mock('@/utils/supabase/client', () => ({
    createClient: () => ({
        auth: {
            getUser: jest.fn().mockResolvedValue({
                data: { user: { id: 'test-user-id' } }
            })
        },
        from: jest.fn(() => ({
            select: jest.fn().mockReturnThis(),
            eq: jest.fn().mockReturnThis(),
            maybeSingle: jest.fn().mockResolvedValue({ data: null })
        }))
    })
}));

describe('BookmarkButton', () => {
    it('ì°œí•˜ê¸° ë²„íŠ¼ì´ ë Œë”ë§ëœë‹¤', () => {
        render(<BookmarkButton courseId={123} />);
        const button = screen.getByRole('button');
        expect(button).toBeInTheDocument();
    });

    it('í´ë¦­ ì‹œ ì°œ ìƒíƒœê°€ í† ê¸€ëœë‹¤', async () => {
        render(<BookmarkButton courseId={123} />);
        const button = screen.getByRole('button');

        fireEvent.click(button);

        await waitFor(() => {
            // í•˜íŠ¸ ì•„ì´ì½˜ì´ ì±„ì›Œì¡ŒëŠ”ì§€ í™•ì¸
            expect(button.querySelector('.fill-current')).toBeInTheDocument();
        });
    });
});
```

package.jsonì— ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€:
```json
{
    "scripts": {
        "test": "jest",
        "test:watch": "jest --watch",
        "test:coverage": "jest --coverage"
    }
}
```

### 7-2. E2E í…ŒìŠ¤íŠ¸ (Playwright)
PlaywrightëŠ” ì´ë¯¸ ì„¤ì¹˜ë˜ì–´ ìˆìœ¼ë¯€ë¡œ í…ŒìŠ¤íŠ¸ë§Œ ì¶”ê°€:

íŒŒì¼: e2e/courses.spec.ts (ìƒˆ íŒŒì¼)
```typescript
import { test, expect } from '@playwright/test';

test.describe('ê°•ì¢Œ ê²€ìƒ‰ ë° ì°œí•˜ê¸°', () => {
    test('ë©”ì¸ í˜ì´ì§€ì—ì„œ ê°•ì¢Œ ëª©ë¡ì´ í‘œì‹œëœë‹¤', async ({ page }) => {
        await page.goto('/');

        // ê°•ì¢Œ ì¹´ë“œê°€ ìµœì†Œ 1ê°œ ì´ìƒ ìˆëŠ”ì§€
        const courseCards = page.locator('[data-testid="course-card"]');
        await expect(courseCards).toHaveCountGreaterThan(0);
    });

    test('ë¡œê·¸ì¸í•˜ì§€ ì•Šê³  ì°œí•˜ê¸°ë¥¼ ëˆ„ë¥´ë©´ ë¡œê·¸ì¸ ëª¨ë‹¬ì´ ëœ¬ë‹¤', async ({ page }) => {
        await page.goto('/');

        // ì²« ë²ˆì§¸ ê°•ì¢Œì˜ ì°œ ë²„íŠ¼ í´ë¦­
        await page.locator('[data-testid="bookmark-button"]').first().click();

        // ë¡œê·¸ì¸ ëª¨ë‹¬ì´ í‘œì‹œë˜ëŠ”ì§€
        await expect(page.locator('[data-testid="login-modal"]')).toBeVisible();
    });

    test('ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í”Œë¡œìš°ê°€ ë™ì‘í•œë‹¤', async ({ page }) => {
        await page.goto('/');

        // ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­
        await page.click('text=ë¡œê·¸ì¸');

        // ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­
        await page.click('text=ì¹´ì¹´ì˜¤ë¡œ ì‹œì‘í•˜ê¸°');

        // ì¹´ì¹´ì˜¤ OAuth í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ í™•ì¸
        await expect(page).toHaveURL(/kauth.kakao.com/);
    });
});
```

package.json:
```json
{
    "scripts": {
        "test:e2e": "playwright test",
        "test:e2e:ui": "playwright test --ui"
    }
}
```

### 7-3. Sentry ì—ëŸ¬ ì¶”ì 
íŒŒì¼: sentry.client.config.ts, sentry.server.config.ts (ìƒˆ íŒŒì¼)

```bash
npx @sentry/wizard@latest -i nextjs
```

ìœ„ ëª…ë ¹ì–´ë¡œ ìë™ ì„¤ì • í›„, ì¶”ê°€ ì„¤ì •:

```typescript
// sentry.client.config.ts
import * as Sentry from '@sentry/nextjs';

Sentry.init({
    dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,
    tracesSampleRate: 0.1,
    environment: process.env.NODE_ENV,

    beforeSend(event, hint) {
        // ë¯¼ê° ì •ë³´ í•„í„°ë§
        if (event.request) {
            delete event.request.cookies;
            delete event.request.headers;
        }
        return event;
    },
});
```

íŒŒì¼: /lib/error-handler.ts (ìƒˆ íŒŒì¼)
```typescript
import * as Sentry from '@sentry/nextjs';

export function reportError(error: Error, context?: Record<string, any>) {
    console.error('Error:', error);

    if (process.env.NODE_ENV === 'production') {
        Sentry.captureException(error, {
            extra: context,
        });
    }
}

// ì‚¬ìš© ì˜ˆ
try {
    await supabase.from('courses').insert(...);
} catch (error) {
    reportError(error as Error, { action: 'insert_course', userId });
    toast.error('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
}
```

### 7-4. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ (Vercel Analytics)
íŒŒì¼: /app/layout.tsx

Vercelì— ë°°í¬ëœ ê²½ìš° ìë™ìœ¼ë¡œ Analytics í™œì„±í™”ë˜ì§€ë§Œ, ëª…ì‹œì ìœ¼ë¡œ ì¶”ê°€:

```bash
npm install @vercel/analytics
```

```typescript
import { Analytics } from '@vercel/analytics/react';

export default function RootLayout({ children }) {
    return (
        <html>
            <body>
                {children}
                <Analytics />
            </body>
        </html>
    );
}
```

### 7-5. ì‚¬ìš©ì í–‰ë™ ì¶”ì  (Google Analytics 4)
íŒŒì¼: /app/layout.tsx

ì´ë¯¸ gtag.jsê°€ ì¶”ê°€ë˜ì–´ ìˆë‹¤ë©´ í™•ì¸ë§Œ, ì—†ë‹¤ë©´ ì¶”ê°€:

```typescript
import Script from 'next/script';

export default function RootLayout({ children }) {
    return (
        <html>
            <head>
                <Script
                    src={`https://www.googletagmanager.com/gtag/js?id=${process.env.NEXT_PUBLIC_GA_ID}`}
                    strategy="afterInteractive"
                />
                <Script id="google-analytics" strategy="afterInteractive">
                    {`
                        window.dataLayer = window.dataLayer || [];
                        function gtag(){dataLayer.push(arguments);}
                        gtag('js', new Date());
                        gtag('config', '${process.env.NEXT_PUBLIC_GA_ID}');
                    `}
                </Script>
            </head>
            <body>{children}</body>
        </html>
    );
}
```

íŒŒì¼: /lib/analytics.ts (ìƒˆ íŒŒì¼)
ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ ì¶”ì :

```typescript
export function trackEvent(name: string, params?: Record<string, any>) {
    if (typeof window !== 'undefined' && window.gtag) {
        window.gtag('event', name, params);
    }
}

// ì‚¬ìš© ì˜ˆ
trackEvent('bookmark_added', { course_id: 123, course_title: 'ìˆ˜ì˜ ì´ˆê¸‰ë°˜' });
trackEvent('search', { search_term: 'ìš”ê°€', result_count: 15 });
```

### 7-6. í—¬ìŠ¤ì²´í¬ ì—”ë“œí¬ì¸íŠ¸
íŒŒì¼: /app/api/health/route.ts (ìƒˆ íŒŒì¼)

ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸ìš© ì—”ë“œí¬ì¸íŠ¸:

```typescript
import { NextResponse } from 'next/server';
import { createClient } from '@supabase/supabase-js';

export async function GET() {
    const checks = {
        api: 'ok',
        database: 'unknown',
        timestamp: new Date().toISOString(),
    };

    try {
        // DB ì—°ê²° í™•ì¸
        const supabase = createClient(
            process.env.NEXT_PUBLIC_SUPABASE_URL!,
            process.env.SUPABASE_SERVICE_ROLE_KEY!
        );

        const { error } = await supabase.from('courses').select('id').limit(1);
        checks.database = error ? 'error' : 'ok';
    } catch (error) {
        checks.database = 'error';
    }

    const allOk = Object.values(checks).every(v => v === 'ok' || typeof v === 'string' && v !== 'error');

    return NextResponse.json(checks, {
        status: allOk ? 200 : 503,
    });
}
```

ì™¸ë¶€ ëª¨ë‹ˆí„°ë§ ì„œë¹„ìŠ¤(UptimeRobot, Pingdom ë“±)ì—ì„œ ì£¼ê¸°ì ìœ¼ë¡œ í˜¸ì¶œ.

## ì˜ˆìƒ ê²°ê³¼
- ë°°í¬ ì „ ë²„ê·¸ ì¡°ê¸° ë°œê²¬
- í”„ë¡œë•ì…˜ ì—ëŸ¬ ì‹¤ì‹œê°„ ê°ì§€
- ì„±ëŠ¥ ë³‘ëª© ì§€ì  íŒŒì•…
- ì‚¬ìš©ì í–‰ë™ íŒ¨í„´ ë¶„ì„
- ì„œë¹„ìŠ¤ ì•ˆì •ì„± í–¥ìƒ
```

---

## 8ï¸âƒ£ ì¶”ê°€ ê¸°ëŠ¥ ì œì•ˆ (ìš°ì„ ìˆœìœ„ ë‚®ìŒ, í–¥í›„ í™•ì¥)

```
# ì‘ì—… ëª…: ì¶”ê°€ ê¸°ëŠ¥ êµ¬í˜„ (ì¥ê¸° ë¡œë“œë§µ)

## ë‹¤ìŒ ê¸°ëŠ¥ë“¤ì€ ì¦‰ì‹œ í•„ìš”í•˜ì§€ ì•Šì§€ë§Œ, í–¥í›„ ê³ ë ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

### 8-1. ê°•ì¢Œ ë¦¬ë·° ë° í‰ì  ì‹œìŠ¤í…œ
- ìˆ˜ê°• í›„ê¸° ì‘ì„±
- ë³„ì  í‰ê°€
- ë„ì›€ì´ ë˜ì—ˆì–´ìš” íˆ¬í‘œ

### 8-2. ì†Œì…œ ê¸°ëŠ¥
- ì¹œêµ¬ ì¶”ê°€ ë° íŒ”ë¡œìš°
- ì°œí•œ ê°•ì¢Œ ê³µìœ 
- ì¶”ì²œ ê°•ì¢Œ ê³µìœ 

### 8-3. AI ê¸°ë°˜ ì¶”ì²œ ì‹œìŠ¤í…œ
- ì‚¬ìš©ì ì·¨í–¥ ë¶„ì„ (ì°œí•œ ê°•ì¢Œ, ê²€ìƒ‰ ì´ë ¥)
- ê°œì¸í™”ëœ ê°•ì¢Œ ì¶”ì²œ
- ìœ ì‚¬í•œ ê°•ì¢Œ ì°¾ê¸°

### 8-4. ìº˜ë¦°ë” ì—°ë™
- ê°•ì¢Œ ì¼ì •ì„ Google Calendar/Outlookì— ì¶”ê°€
- iCal íŒŒì¼ ë‹¤ìš´ë¡œë“œ

### 8-5. ê°•ì¢Œ ì•Œë¦¼ ì±„ë„ í™•ì¥
- ì¹´ì¹´ì˜¤í†¡ ì•Œë¦¼í†¡ (ë¹„ìš© ë°œìƒ)
- SMS ì•Œë¦¼ (ì¤‘ìš” ê°•ì¢Œë§Œ)
- Slack/Discord ì›¹í›… (ì»¤ë®¤ë‹ˆí‹°ìš©)

### 8-6. ê´€ë¦¬ì ê¸°ëŠ¥ ê°•í™”
- ê°•ì¢Œ ìˆ˜ë™ ë“±ë¡/í¸ì§‘ UI
- ì‚¬ìš©ì ê´€ë¦¬ (ì •ì§€, ê²½ê³ )
- í†µê³„ ëŒ€ì‹œë³´ë“œ (ê°€ì…ì ìˆ˜, í™œì„± ì‚¬ìš©ì, ì¸ê¸° ê°•ì¢Œ ë“±)

### 8-7. PWA ê¸°ëŠ¥ í™œìš©
- ì˜¤í”„ë¼ì¸ ëª¨ë“œ (ìºì‹œëœ ê°•ì¢Œ ëª©ë¡ í‘œì‹œ)
- í™ˆ í™”ë©´ ì¶”ê°€ í”„ë¡¬í”„íŠ¸
- ì•± ê°™ì€ ë„¤ë¹„ê²Œì´ì…˜

### 8-8. ë‹¤êµ­ì–´ ì§€ì›
- i18next ë„ì…
- ì˜ì–´, ì¼ë³¸ì–´ ë“± ì¶”ê°€

### 8-9. ë‹¤í¬ ëª¨ë“œ
- ì‹œìŠ¤í…œ ì„¤ì • ê°ì§€
- ìˆ˜ë™ í† ê¸€

### 8-10. ê°•ì¢Œ í•„í„° ê³ ë„í™”
- ê°€ê²© ë²”ìœ„ í•„í„°
- ìš”ì¼/ì‹œê°„ëŒ€ í•„í„°
- ë‚œì´ë„ í•„í„°
- ê°•ì‚¬ëª… ê²€ìƒ‰
```

---

## âœ… ê° í”„ë¡¬í”„íŠ¸ ì‹¤í–‰ ë°©ë²•

1. **AI ì—ì´ì „íŠ¸ì— í”„ë¡¬í”„íŠ¸ ë³µì‚¬/ë¶™ì—¬ë„£ê¸°**
   - ìœ„ì˜ ê° ì„¹ì…˜(1ë²ˆ~8ë²ˆ) ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒ
   - ì „ì²´ ì½”ë“œ ë¸”ë¡ì„ ë³µì‚¬
   - AI ì—ì´ì „íŠ¸ì— ë¶™ì—¬ë„£ê¸°

2. **ì—ì´ì „íŠ¸ê°€ ì½”ë“œ ìƒì„± ë° íŒŒì¼ ìˆ˜ì •**
   - ì—ì´ì „íŠ¸ê°€ ìë™ìœ¼ë¡œ íŒŒì¼ ìƒì„±/ìˆ˜ì •
   - í•„ìš”í•œ ì˜ì¡´ì„± ì„¤ì¹˜ ëª…ë ¹ì–´ ì œê³µ

3. **ë¡œì»¬ì—ì„œ í…ŒìŠ¤íŠ¸**
   ```bash
   npm install  # ìƒˆ ì˜ì¡´ì„± ì„¤ì¹˜
   npm run dev  # ê°œë°œ ì„œë²„ ì‹¤í–‰
   ```

4. **ë¬¸ì œì—†ìœ¼ë©´ ì»¤ë°‹ ë° ë°°í¬**
   ```bash
   git add .
   git commit -m "feat: [ê°œì„  ë‚´ìš©]"
   git push
   ```

5. **ë‹¤ìŒ í”„ë¡¬í”„íŠ¸ë¡œ ì§„í–‰**
   - ë‹¤ìŒ ìš°ì„ ìˆœìœ„ í”„ë¡¬í”„íŠ¸ ì‹¤í–‰

---

## ğŸ“š ì°¸ê³  ìë£Œ

### í˜„ì¬ ê¸°ìˆ  ìŠ¤íƒ ë¬¸ì„œ
- [Next.js 16 ê³µì‹ ë¬¸ì„œ](https://nextjs.org/docs)
- [Supabase ë¬¸ì„œ](https://supabase.com/docs)
- [Tailwind CSS](https://tailwindcss.com/docs)
- [Playwright](https://playwright.dev/)
- [React Query (TanStack Query)](https://tanstack.com/query/latest)

### ë³´ì•ˆ ê°€ì´ë“œ
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Next.js ë³´ì•ˆ ëª¨ë²” ì‚¬ë¡€](https://nextjs.org/docs/app/building-your-application/configuring/environment-variables#runtime-environment-variables)

### ì„±ëŠ¥ ìµœì í™”
- [Next.js ì„±ëŠ¥ ê°€ì´ë“œ](https://nextjs.org/docs/app/building-your-application/optimizing)
- [Web Vitals](https://web.dev/vitals/)

---

## ğŸ¯ ë§ˆë¬´ë¦¬

ì´ ë¬¸ì„œëŠ” ìš°ë™ë°° í”„ë¡œì íŠ¸ë¥¼ **ìƒìš© ì„œë¹„ìŠ¤ ìˆ˜ì¤€**ìœ¼ë¡œ ëŒì–´ì˜¬ë¦¬ê¸° ìœ„í•œ ì¢…í•© ê°œì„  ê³„íšì…ë‹ˆë‹¤.

**í•µì‹¬ ê°œì„ ì‚¬í•­:**
- ğŸ”” ì•Œë¦¼ ì‹œìŠ¤í…œ ê³ ë„í™” (ì„¤ì •, ì‹¤ì‹œê°„, í†µê³„)
- ğŸ‘¤ íšŒì› ê¸°ëŠ¥ ê°•í™” (í”„ë¡œí•„ í¸ì§‘, í™œë™ íˆìŠ¤í† ë¦¬, ì´ë©”ì¼ ê°€ì…, íƒˆí‡´)
- ğŸ”’ ë³´ì•ˆ ê°•í™” (ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”, Rate Limiting, CSRF)
- ğŸ—„ï¸ DB ìµœì í™” (ì¸ë±ìŠ¤, RLS, ê°ì‚¬ ë¡œê·¸)
- âš¡ ì„±ëŠ¥ ê°œì„  (ìºì‹±, ë¬´í•œ ìŠ¤í¬ë¡¤, ì´ë¯¸ì§€ ìµœì í™”)
- ğŸ¨ UX ê°œì„  (Toast, ìŠ¤ì¼ˆë ˆí†¤, ì ‘ê·¼ì„±)
- ğŸ§ª í…ŒìŠ¤íŠ¸ & ëª¨ë‹ˆí„°ë§ (Jest, Playwright, Sentry)

**ì˜ˆìƒ ì†Œìš” ì‹œê°„:**
- Phase 1 (ìµœìš°ì„ ): 1-2ì£¼
- Phase 2 (ë‹¨ê¸°): 2-4ì£¼
- Phase 3 (ì¤‘ì¥ê¸°): 1-2ê°œì›”

**ì‹¤í–‰ ìˆœì„œ:**
1. ì•Œë¦¼ ì‹œìŠ¤í…œ ê°œì„  (í”„ë¡¬í”„íŠ¸ 1)
2. íšŒì› ê¸°ëŠ¥ ê°•í™” (í”„ë¡¬í”„íŠ¸ 2)
3. ë³´ì•ˆ ì·¨ì•½ì  í•´ê²° (í”„ë¡¬í”„íŠ¸ 4)
4. ì´í›„ ìš°ì„ ìˆœìœ„ì— ë”°ë¼ ì§„í–‰

ê° í”„ë¡¬í”„íŠ¸ëŠ” ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ ê°€ëŠ¥í•˜ë©°, AI ì—ì´ì „íŠ¸ê°€ ë°”ë¡œ ì‘ì—…í•  ìˆ˜ ìˆë„ë¡ êµ¬ì²´ì ì¸ ì½”ë“œ ì˜ˆì‹œì™€ íŒŒì¼ ê²½ë¡œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

**ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ë©´ ì´ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì—¬ ì¶”ê°€ ì‘ì—…ì„ ìš”ì²­í•˜ì„¸ìš”!**
